import{c as H}from"./overlayControls-BKEkg_Gn.js";/* empty css              */import{e as N,M as B,B as V,h as k,d as z}from"./color-CIVhf6zH.js";const e={ROWS:11,COLS:7,OVERLAP_PERCENT:15,TRAIL_LIFE_PERCENT:65,GRID_SIZE:100,GRID_COLOR_PANEL:"#00ff6a",GRID_COLOR_MAJOR:"#00ff6a",SHOW_GRID_OUTER_BOX:!0,SHOW_GRID_LINES:!0,SHOW_GRID_BACKGROUND:!0,OVERLAY_TEXT_SIZE:18,OVERLAY_TEXT_COLOR:"#00ff6a",SAMPLE_RESOLUTION:2400,GRID_GAP_PERCENT:4,TEXT_SCALE_FACTOR:1.5,VIEWPORT_HORIZONTAL_PADDING:.05,VIEWPORT_VERTICAL_PADDING:.05};document.getElementById("multi-grid");const u=document.getElementById("data-counter");let a=null,R=null,n=null,S=!1,c=[];function M(){const i=document.getElementById("multi-grid");if(!i)return e.OVERLAY_TEXT_SIZE;const l=i.clientWidth/e.COLS,o=i.clientHeight/e.ROWS,s=e.GRID_GAP_PERCENT/100,p=l*(1-s),O=o*(1-s),g=Math.min(p,O),r=Math.max(8,Math.min(24,g*.08))*e.TEXT_SCALE_FACTOR;return Math.round(r)}function C(){const i=M();e.OVERLAY_TEXT_SIZE=i,document.documentElement.style.setProperty("--overlay-text-size",i+"px");const l=Math.max(10,Math.min(60,i*1.2));e.TOTAL_BEATS_SIZE=l;const o=document.getElementById("data-counter");o&&(o.style.fontSize=l+"px")}function F(){R&&R.stop(),a&&a.dispose();const i=document.getElementById("multi-grid");i.innerHTML="",i.style.flex="1 1 auto",i.style.minHeight="100px",i.style.display="block",i.style.position="relative";const l=document.createElement("canvas"),o=document.createElement("canvas"),s=document.createElement("div");o.style.background="transparent",l.style.position="absolute",o.style.position="absolute",s.style.position="absolute",l.style.top=o.style.top="0",l.style.left=o.style.left="0",l.style.width=o.style.width="100%",l.style.height=o.style.height="100%",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.style.pointerEvents="none",o.style.pointerEvents="none",i.style.position="relative",i.appendChild(l),i.appendChild(o),i.appendChild(s),c.length=0,s.innerHTML="";for(let r=0;r<e.ROWS*e.COLS;r++){const t=document.createElement("div");t.className="cell-overlay",t.innerHTML='<span class="ov bpm">BPM: --</span><span class="ov beats">Beat Count: 0</span>',s.appendChild(t),c.push(t)}function p(){const r=i.clientWidth||i.offsetWidth,t=i.clientHeight||i.offsetHeight;if(!r||!t)return;const E=r*e.VIEWPORT_HORIZONTAL_PADDING,d=r*e.VIEWPORT_VERTICAL_PADDING,I=r-2*E,P=t-2*d,h=I/e.COLS,y=e.GRID_GAP_PERCENT/100,T=h*y,L=h*y,G=T*(e.COLS-1),A=L*(e.ROWS-1),b=(I-G)/e.COLS,D=(P-A)/e.ROWS;for(let _=0;_<c.length;_++){const w=_%e.COLS,x=Math.floor(_/e.COLS),m=c[_],W=E+w*(b+T)+8,v=d+x*(D+L)+6;m.style.transform=`translate(${W}px, ${v}px)`,m.style.flexDirection="row",m.style.alignItems="center",m.style.gap="8px"}}function O(){z(l,{rows:e.ROWS,cols:e.COLS,gridSize:e.GRID_SIZE,gridColorMajor:e.GRID_COLOR_MAJOR,gridColorPanel:e.GRID_COLOR_PANEL,showGridOuterBox:e.SHOW_GRID_OUTER_BOX,showGridLines:e.SHOW_GRID_LINES,showGridBackground:e.SHOW_GRID_BACKGROUND,gridGapPercent:e.GRID_GAP_PERCENT,viewportHorizontalPadding:e.VIEWPORT_HORIZONTAL_PADDING,viewportVerticalPadding:e.VIEWPORT_VERTICAL_PADDING})}O(),n=O,S||(window.addEventListener("resize",()=>{n&&n(),c.length&&p(),a&&(a.updateDimensions(window.innerWidth,window.innerHeight),a.resize()),C()}),S=!0),a=new B(o,{rows:e.ROWS,cols:e.COLS,overlapPercent:e.OVERLAP_PERCENT,trailLifePercent:e.TRAIL_LIFE_PERCENT,lineWidth:4,glow:!1,colorCore:[0,1,0,.9],viewportHorizontalPadding:e.VIEWPORT_HORIZONTAL_PADDING,viewportVerticalPadding:e.VIEWPORT_VERTICAL_PADDING,heartRateMode:"auto",gridSize:e.GRID_SIZE,showGrid:e.SHOW_GRID_OUTER_BOX||e.SHOW_GRID_LINES,gridColor:e.GRID_COLOR_MAJOR,renderWidth:window.innerWidth,renderHeight:window.innerHeight}),R=new V(a),R.start(),p(),document.documentElement.style.setProperty("--overlay-text-size",e.OVERLAY_TEXT_SIZE+"px"),document.documentElement.style.setProperty("--overlay-text-color",e.OVERLAY_TEXT_COLOR),C();let g=0;function f(r){if(a&&r-g>60){g=r,u.textContent=`Total Beats: ${a.totalBeats().toLocaleString()}`;for(let t=0;t<a.traces.length&&t<c.length;t++){const E=a.traces[t],d=c[t];d._bpmEl||(d._bpmEl=d.querySelector(".bpm"),d._beatsEl=d.querySelector(".beats")),d._bpmEl&&(d._bpmEl.textContent="BPM: "+Math.round(E.heartRate)),d._beatsEl&&(d._beatsEl.textContent="Beat Count: "+E.beatCount)}}requestAnimationFrame(f)}requestAnimationFrame(f),H({title:"Multi-ECG Configuration",sections:[{title:"Grid",fields:[{type:"range",name:"gridSize",label:"Grid Size",value:100,min:20,max:160,step:2},{type:"range",name:"viewportHorizontalPadding",label:"Horizontal Padding %",value:5,min:0,max:20,step:1},{type:"range",name:"viewportVerticalPadding",label:"Vertical Padding %",value:5,min:0,max:20,step:1},{type:"range",name:"gridGap",label:"Grid Gap %",value:4,min:0,max:50,step:1},{type:"color",name:"gridColorPanel",label:"Panel Grid Color",value:"#00ff6a"},{type:"color",name:"gridColorLines",label:"Grid Lines Color",value:"#00ff6a"},{type:"checkbox",name:"showGridOuterBox",label:"Show Outer Box",value:!0},{type:"checkbox",name:"showGridLines",label:"Show Grid Lines",value:!0},{type:"checkbox",name:"showGridBackground",label:"Show Background",value:!0}]},{title:"Trace",fields:[{type:"range",name:"coreWidth",label:"Core Width",value:4,min:.5,max:16,step:.1},{type:"range",name:"headSize",label:"Head Dot Size",value:10,min:2,max:28,step:.5},{type:"range",name:"edgeFeather",label:"Edge Feather",value:.22,min:0,max:.95,step:.01},{type:"range",name:"edgeFade",label:"Edge Fade (Longitudinal)",value:.06,min:0,max:.25,step:.005},{type:"range",name:"trail",label:"Trail % Beat",value:65,min:5,max:200,step:1},{type:"range",name:"overlap",label:"Overlap %",value:15,min:0,max:80,step:1},{type:"color",name:"coreColor",label:"Core Color",value:"#00ff6a"}]},{title:"Text",fields:[{type:"range",name:"textScale",label:"Text Scale Factor",value:1.5,min:.5,max:2,step:.1},{type:"color",name:"textColor",label:"Text Color",value:"#00ff6a"}]}],onChange:(r,t)=>{if(a)switch(r){case"overlap":a.updateConfig({overlapPercent:+t});break;case"trail":a.updateConfig({trailLifePercent:+t});break;case"coreWidth":a.updateConfig({lineWidth:+t});break;case"headSize":a.updateConfig({headDotRadius:+t});break;case"edgeFeather":a.updateConfig({edgeFeather:+t});break;case"edgeFade":a.updateConfig({edgeSpatialFade:+t});break;case"gridGap":e.GRID_GAP_PERCENT=+t,n&&n(),c.length&&p(),C();break;case"viewportPerimeterPadding":e.VIEWPORT_PERIMETER_PADDING=+t/100,a&&a.updateConfig({viewportPerimeterPadding:+t/100}),n&&n(),c.length&&p();break;case"viewportHorizontalPadding":e.VIEWPORT_HORIZONTAL_PADDING=+t/100,a&&a.updateConfig({viewportHorizontalPadding:+t/100}),n&&n(),c.length&&p();break;case"viewportVerticalPadding":e.VIEWPORT_VERTICAL_PADDING=+t/100,a&&a.updateConfig({viewportVerticalPadding:+t/100}),n&&n(),c.length&&p();break;case"coreColor":a.updateConfig({colorCore:k(t,.95)}),a._colorCore=new Float32Array(a.cfg.colorCore);break;case"gridSize":e.GRID_SIZE=+t,n&&n();break;case"gridColorPanel":e.GRID_COLOR_PANEL=t,n&&n();break;case"gridColorLines":e.GRID_COLOR_MAJOR=t,n&&n();break;case"showGridOuterBox":e.SHOW_GRID_OUTER_BOX=t,n&&n();break;case"showGridLines":e.SHOW_GRID_LINES=t,n&&n();break;case"showGridBackground":e.SHOW_GRID_BACKGROUND=t,n&&n();break;case"textColor":e.OVERLAY_TEXT_COLOR=t,document.documentElement.style.setProperty("--overlay-text-color",t);const E=document.getElementById("data-counter");E&&(E.style.color=t);break;case"textScale":e.TEXT_SCALE_FACTOR=+t,C();break}}})}N({sampleResolution:e.SAMPLE_RESOLUTION}).then(()=>{u.textContent="Total Beats: 0",u.style.color=e.OVERLAY_TEXT_COLOR,F()});
