import{r as F,c as q}from"./overlayControls_new-C67KsuMk.js";/* empty css              */import{h as O,e as N,M as X,B as Y,d as j}from"./color-8XwccIkK.js";const e={"ECG: Trace Width":{value:4,type:"range",min:.5,max:16,step:.1,label:"ECG: Trace Width"},"ECG: Head Size":{value:10,type:"range",min:2,max:28,step:.5,label:"ECG: Head Dot Size"},"ECG: Trail Life":{value:65,type:"range",min:5,max:200,step:1,label:"ECG: Trail Life %"},"ECG: Overlap":{value:15,type:"range",min:0,max:80,step:1,label:"ECG: Overlap %"},"ECG: Trace Color":{value:"#00ff6a",type:"color",label:"ECG: Trace Color"},"ECG: Grid Size":{value:100,type:"range",min:20,max:160,step:2,label:"ECG: Grid Size"},"ECG: Horizontal Padding":{value:5,type:"range",min:0,max:20,step:1,label:"ECG: Horizontal Padding %"},"ECG: Vertical Padding":{value:5,type:"range",min:0,max:20,step:1,label:"ECG: Vertical Padding %"},"ECG: Grid Gap":{value:4,type:"range",min:0,max:10,step:1,label:"ECG: Grid Gap %"},"ECG: Panel Grid Color":{value:"#00ff6a",type:"color",label:"ECG: Panel Grid Color"},"ECG: Grid Lines Color":{value:"#00ff6a",type:"color",label:"ECG: Grid Lines Color"},"ECG: Show Outer Box":{value:!0,type:"checkbox",label:"ECG: Show Outer Box"},"ECG: Show Grid Lines":{value:!0,type:"checkbox",label:"ECG: Show Grid Lines"},"ECG: Show Background":{value:!0,type:"checkbox",label:"ECG: Show Background"},"ECG: Text Scale":{value:1.2,type:"range",min:.5,max:2,step:.1,label:"ECG: Text Scale Factor"},"ECG: Text Color":{value:"#00ff6a",type:"color",label:"ECG: Text Color"},"ECG: Show Counter Prefixes":{value:!0,type:"checkbox",label:"ECG: Show Counter Prefixes"},"ECG: Show Beats Counter":{value:!0,type:"checkbox",label:"ECG: Show Beats Counter"},"ECG: Show BPM Counter":{value:!0,type:"checkbox",label:"ECG: Show BPM Counter"},"Internal: ECG Sample Resolution":2400,"Internal: ECG Rows":10,"Internal: ECG Cols":8,"Internal: ECG Show BPM Counter":!0,"Internal: ECG Show Rate Counter":!0,"Internal: ECG Show Counter Prefixes":!0};F("config",e,{onChange:(t,o,s)=>{if(["ECG: Trace Width","ECG: Head Size","ECG: Trail Life","ECG: Overlap","ECG: Trace Color","ECG: Grid Size","ECG: Horizontal Padding","ECG: Vertical Padding","ECG: Grid Gap","ECG: Panel Grid Color","ECG: Grid Lines Color","ECG: Show Outer Box","ECG: Show Grid Lines","ECG: Show Background"].includes(t)){if(!n)return;const l={};t==="ECG: Trace Width"?l.lineWidth=o:t==="ECG: Head Size"?l.headDotRadius=o:t==="ECG: Trail Life"?l.trailLifePercent=o:t==="ECG: Overlap"?l.overlapPercent=o:t==="ECG: Trace Color"?(l.colorCore=O(o,.95),n._colorCore=new Float32Array(n.cfg.colorCore)):(t==="ECG: Grid Size"||t==="ECG: Horizontal Padding"||t==="ECG: Vertical Padding"||t==="ECG: Grid Gap"||t==="ECG: Panel Grid Color"||t==="ECG: Grid Lines Color"||t==="ECG: Show Outer Box"||t==="ECG: Show Grid Lines"||t==="ECG: Show Background")&&(v&&v(),c&&c(),b()),Object.keys(l).length>0&&n.updateConfig(l);return}if(t==="ECG: Text Scale")b(),c&&setTimeout(()=>c(),50);else if(t==="ECG: Text Color"){document.documentElement.style.setProperty("--overlay-text-color",o);const l=document.getElementById("data-counter");l&&(l.style.color=o)}else if((t==="ECG: Show Counter Prefixes"||t==="ECG: Show Beats Counter"||t==="ECG: Show BPM Counter")&&overlayLayer){overlayLayer.innerHTML="",u.length=0;for(let l=0;l<e["Internal: ECG Rows"]*e["Internal: ECG Cols"];l++){const G=document.createElement("div");G.className="cell-overlay";const p=e["ECG: Show Counter Prefixes"].value?"Beats: ":"",m=e["ECG: Show Counter Prefixes"].value?"BPM: ":"",h=e["ECG: Show Beats Counter"].value?`<span class="ov beats">${p}0</span>`:"",w=e["ECG: Show BPM Counter"].value?`<span class="ov bpm">${m}--</span>`:"";G.innerHTML=h+w,overlayLayer.appendChild(G),u.push(G)}c&&setTimeout(()=>c(),50)}}});document.getElementById("multi-grid");const x=document.getElementById("data-counter");let n=null,S=null,v=null,W=!1,u=[];function R(){const t=document.getElementById("multi-grid");if(!t)return e["ECG: Text Scale"].value*18;const o=t.clientWidth/e["Internal: ECG Cols"],s=t.clientHeight/e["Internal: ECG Rows"],C=e["ECG: Grid Gap"].value/100,l=o*(1-C),G=s*(1-C),p=Math.min(l,G),h=Math.max(8,Math.min(50,p*.12))*e["ECG: Text Scale"].value;return Math.round(h)}function b(){const t=R();document.documentElement.style.setProperty("--overlay-text-size",t+"px");const o=Math.max(10,Math.min(90,t*1.4)),s=document.getElementById("data-counter");s&&(s.style.fontSize=o+"px")}let c=null;function U(){window.innerHeight>window.innerWidth&&(e["Internal: ECG Show BPM Counter"]=!1);const t=window.innerWidth/window.innerHeight;if(t>1.5){const r=t-1.5,i=Math.floor(r/.1)*1;e["ECG: Horizontal Padding"].value=5+i}S&&S.stop(),n&&n.dispose();const o=document.getElementById("multi-grid");o.innerHTML="",o.style.flex="1 1 auto",o.style.minHeight="100px",o.style.display="block",o.style.position="relative";const s=document.createElement("canvas"),C=document.createElement("canvas"),l=document.createElement("div");C.style.background="transparent",s.style.position="absolute",C.style.position="absolute",l.style.position="absolute",s.style.top=C.style.top="0",s.style.left=C.style.left="0",s.style.width=C.style.width="100%",s.style.height=C.style.height="100%",l.style.top="0",l.style.left="0",l.style.width="100%",l.style.height="100%",l.style.pointerEvents="none",C.style.pointerEvents="none",o.style.position="relative",o.appendChild(s),o.appendChild(C),o.appendChild(l),u.length=0,l.innerHTML="";for(let r=0;r<e["Internal: ECG Rows"]*e["Internal: ECG Cols"];r++){const i=document.createElement("div");i.className="cell-overlay";const E=e["ECG: Show Counter Prefixes"].value?"Beats: ":"",a=e["ECG: Show Counter Prefixes"].value?"BPM: ":"",f=e["ECG: Show Beats Counter"].value?`<span class="ov beats">${E}0</span>`:"",y=e["ECG: Show BPM Counter"].value?`<span class="ov bpm">${a}--</span>`:"";i.innerHTML=f+y,l.appendChild(i),u.push(i)}function G(){const r=o.clientWidth||o.offsetWidth,i=o.clientHeight||o.offsetHeight;if(!r||!i)return;r/e["Internal: ECG Cols"],i/e["Internal: ECG Rows"];const E=r*(e["ECG: Horizontal Padding"].value/100),a=r*(e["ECG: Vertical Padding"].value/100),f=r-2*E,y=i-2*a,H=f/e["Internal: ECG Cols"];y/e["Internal: ECG Rows"];const I=e["ECG: Grid Gap"].value/100,T=H*I,z=H*I,k=T*(e["Internal: ECG Cols"]-1),_=z*(e["Internal: ECG Rows"]-1),P=(f-k)/e["Internal: ECG Cols"],B=(y-_)/e["Internal: ECG Rows"];for(let g=0;g<u.length;g++){const V=g%e["Internal: ECG Cols"],A=Math.floor(g/e["Internal: ECG Cols"]),d=u[g],L=Math.max(6,Math.min(16,P*.025)),M=Math.max(4,Math.min(12,B*.02)),$=E+V*(P+T)+L,D=a+A*(B+z)+M;d.style.transform=`translate(${$}px, ${D}px)`,d.style.position="absolute",d.style.zIndex="10",d.style.width=P-2*L+"px",d.style.height=B-2*M+"px",d.style.display="block",d.style.flexDirection="row",d.style.alignItems="center",d.style.gap="0px"}}c=G;function p(){j(s,{rows:e["Internal: ECG Rows"],cols:e["Internal: ECG Cols"],gridSize:e["ECG: Grid Size"].value,gridColorMajor:e["ECG: Grid Lines Color"].value,gridColorPanel:e["ECG: Panel Grid Color"].value,showGridOuterBox:e["ECG: Show Outer Box"].value,showGridLines:e["ECG: Show Grid Lines"].value,showGridBackground:e["ECG: Show Background"].value,gridGapPercent:e["ECG: Grid Gap"].value,viewportHorizontalPadding:e["ECG: Horizontal Padding"].value/100,viewportVerticalPadding:e["ECG: Vertical Padding"].value/100})}p(),v=p,W||(window.addEventListener("resize",()=>{v&&v(),n&&(n.updateDimensions(window.innerWidth,window.innerHeight),n.resize()),c&&c(),b(),updateLocalOverlayConfig(),document.getElementById("multi-grid")&&window.innerWidth<600&&setTimeout(()=>{c&&c()},100)}),W=!0),n=new X(C,{rows:e["Internal: ECG Rows"],cols:e["Internal: ECG Cols"],overlapPercent:e["ECG: Overlap"].value,trailLifePercent:e["ECG: Trail Life"].value,lineWidth:e["ECG: Trace Width"].value,glow:!1,colorCore:O(e["ECG: Trace Color"].value,.95),viewportHorizontalPadding:e["ECG: Horizontal Padding"].value/100,viewportVerticalPadding:e["ECG: Vertical Padding"].value/100,heartRateMode:"auto",gridSize:e["ECG: Grid Size"].value,showGrid:e["ECG: Show Outer Box"].value||e["ECG: Show Grid Lines"].value,gridColor:e["ECG: Grid Lines Color"].value,renderWidth:window.innerWidth,renderHeight:window.innerHeight}),S=new Y(n),S.start(),c&&c();const m=R();document.documentElement.style.setProperty("--overlay-text-size",m+"px"),document.documentElement.style.setProperty("--overlay-text-color",e["ECG: Text Color"].value),b();let h=0;function w(r){if(n&&r-h>60){h=r,x.textContent=`Total Beats: ${n.totalBeats().toLocaleString()}`;for(let i=0;i<n.traces.length&&i<u.length;i++){const E=n.traces[i],a=u[i];a._bpmEl||(a._bpmEl=a.querySelector(".bpm"),a._beatsEl=a.querySelector(".beats"));const f=e["ECG: Show Counter Prefixes"].value?"Beats: ":"",y=e["ECG: Show Counter Prefixes"].value?"BPM: ":"";a._beatsEl&&(e["ECG: Show Beats Counter"].value?(a._beatsEl.style.display="inline",a._beatsEl.textContent=f+E.beatCount):a._beatsEl.style.display="none"),a._bpmEl&&(e["ECG: Show BPM Counter"].value?(a._bpmEl.style.display="inline",a._bpmEl.textContent=y+Math.round(E.heartRate)):a._bpmEl.style.display="none")}}requestAnimationFrame(w)}requestAnimationFrame(w),q({title:"Multi-ECG Configuration"})}N({sampleResolution:e["Internal: ECG Sample Resolution"]}).then(()=>{x.textContent="Total Beats: 0",x.style.color=e["ECG: Text Color"].value,U(),document.addEventListener("keydown",t=>{(t.key==="r"||t.key==="R")&&J()})});function J(){if(!(!n||!n.traces)){for(const t of n.traces)t.beatCount=0;x.textContent=`Total Beats: ${n.totalBeats().toLocaleString()}`}}
