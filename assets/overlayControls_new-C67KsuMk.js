(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();class b{constructor(){this.modules=new Map,this.globalConfig={},this.autoConfig=new Map}registerModule(e,t,n={}){return this.modules.set(e,{object:t,metadata:n,instance:null}),this.scanForConfigVars(e,t,n),this}scanForConfigVars(e,t,n={}){const o=[];for(const[s,a]of Object.entries(t))if(this.isConfigObject(a)){const i=n[s]||{};o.push({name:s,key:s,config:a,...i})}o.length>0&&this.autoConfig.set(e,o)}isConfigObject(e){return e&&typeof e=="object"&&!Array.isArray(e)&&e.type&&typeof e.value<"u"}inferMetadata(e,t){const n={type:this.inferType(t)};return e.includes("size")||e.includes("width")||e.includes("height")?(n.min=.5,n.max=e.includes("size")?60:200,n.step=e.includes("size")?1:2):e.includes("percent")||e.includes("trail")||e.includes("overlap")?(n.min=0,n.max=e.includes("percent")?100:200,n.step=1):e.includes("rate")||e.includes("heart")?(n.min=30,n.max=200,n.step=1):e.includes("padding")||e.includes("margin")?(n.min=0,n.max=.2,n.step=.01):(e.includes("glow")||e.includes("feather")||e.includes("fade"))&&(n.min=0,n.max=e.includes("glow")?24:1,n.step=e.includes("glow")?.5:.01),n}inferType(e){return typeof e=="boolean"?"checkbox":typeof e=="number"?"range":typeof e=="string"&&e.startsWith("#")?"color":Array.isArray(e)?"select":"text"}getOverlaySections(){const e=[];for(const[t,n]of this.autoConfig){if(n.length===0)continue;const o=this.modules.get(t),s=n.filter(i=>this.shouldShowField(i,o)).map(i=>({type:i.config.type,name:`${t}.${i.name}`,label:i.config.label||this.formatLabel(i.name),value:i.config.value,min:i.config.min,max:i.config.max,step:i.config.step,options:i.config.options,section:i.config.section||"General"})),a={};s.forEach(i=>{const r=i.section||"General";a[r]||(a[r]=[]),a[r].push(i)}),Object.entries(a).forEach(([i,r])=>{r.length>0&&e.push({title:i,fields:r})})}for(const[t,n]of this.modules){const{definition:o}=n;if(o)if(o.getSections){const s=o.getSections(n.instance);e.push(...s)}else o.sections&&e.push(...o.sections)}return e}shouldShowField(e,t){if(!e.config.condition)return!0;const n=e.config.condition;if(typeof n=="function")return n(t.object);if(typeof n=="object"){for(const[o,s]of Object.entries(n)){const a=this.autoConfig.get(Object.keys(this.autoConfig)[0])?.find(i=>i.name===o);if(a&&t.object[a.key].value!==s)return!1}return!0}return!0}formatLabel(e){return e.replace(/([A-Z])/g," $1").replace(/^./,t=>t.toUpperCase()).replace(/([a-z])([A-Z])/g,"$1 $2").trim()}getOnChangeHandler(){return(e,t)=>{const[n,o]=e.split(".");if(this.autoConfig.has(n)){const a=this.autoConfig.get(n).find(i=>i.name===o);if(a){const i=this.modules.get(n);if(i&&i.object)return i.object[a.key].value=t,i.metadata.onChange&&i.metadata.onChange(o,t,i.instance),this.refreshModule(n),!0}}for(const[s,a]of this.modules){const{definition:i,instance:r}=a;if(i&&i.onChange&&i.onChange(e,t,r))return!0}return!1}}refreshModule(e){const t=this.modules.get(e);t&&t.instance&&(typeof t.instance.updateConfig=="function"?t.instance.updateConfig(this.getModuleConfig(e)):typeof t.instance.refresh=="function"&&t.instance.refresh())}setModuleInstance(e,t){return this.modules.has(e)&&(this.modules.get(e).instance=t),this}getModuleConfig(e){const t=this.modules.get(e);if(!t)return{};const n={};return this.autoConfig.has(e)&&this.autoConfig.get(e).forEach(s=>{n[s.name]=t.object[s.key].value}),t.definition&&t.definition.getCurrentValues&&Object.assign(n,t.definition.getCurrentValues(t.instance)),n}updateModuleConfig(e,t){const n=this.modules.get(e);if(n){if(this.autoConfig.has(e)){const o=this.autoConfig.get(e);Object.entries(t).forEach(([s,a])=>{const i=o.find(r=>r.name===s);i&&(n.object[i.key].value=a)})}n.definition&&n.definition.updateConfig&&n.definition.updateConfig(t,n.instance),this.refreshModule(e)}}}const f=new b;class x{constructor(){this.overlayEl=null,this.open=!1,this.fpsEnabled=!1,this.fpsEl=null,this.lastFpsSample=performance.now(),this.frames=0,this.smoothFps=null,this.boundLoop=null,this.initialized=!1,this.title="Configuration"}init(){this.initialized||(this.ensureOverlayElement(),this.setupGlobalHotkeys(),this.startFpsLoop(),this.initialized=!0)}configure(e){this.title=e.title||"Configuration",this.updateOverlayContent(),this.setupConfigForm()}updateOverlayContent(){if(!this.overlayEl)return;const e=this.overlayEl.querySelector("#config-content");if(!e)return;const t=f.getOverlaySections();e.innerHTML=this.generateConfigHTML(t)}generateConfigHTML(e){return!e||e.length===0?"<p>No configuration options available</p>":e.map(t=>{const n=t.fields.map(o=>this.generateFieldHTML(o)).join("");return`
        <fieldset>
          <legend>${t.title}</legend>
          ${n}
        </fieldset>
      `}).join("")}generateFieldHTML(e){const{type:t,name:n,label:o,value:s,min:a,max:i,step:r,options:h}=e,d=`field-${n}`;switch(t){case"range":return`
          <label>
            ${o}
            <input type="range" name="${n}" id="${d}" min="${a||0}" max="${i||100}" step="${r||1}" value="${s||50}" data-val />
          </label>
        `;case"color":return`
          <label>
            ${o}
            <input type="color" name="${n}" id="${d}" value="${s||"#00ff6a"}" />
          </label>
        `;case"checkbox":return`
          <label>
            <input type="checkbox" name="${n}" id="${d}" ${s?"checked":""} />
            ${o}
          </label>
        `;case"select":const m=h?h.map(p=>`<option value="${p.value}" ${p.value===s?"selected":""}>${p.label}</option>`).join(""):"";return`
          <label>
            ${o}
            <select name="${n}" id="${d}">${m}</select>
          </label>
        `;case"number":return`
          <label>
            ${o}
            <input type="number" name="${n}" id="${d}" min="${a||0}" max="${i||100}" step="${r||1}" value="${s||0}" />
          </label>
        `;default:return""}}setupGlobalHotkeys(){document.addEventListener("keydown",e=>{e.altKey&&(e.code==="KeyP"&&(e.preventDefault(),e.stopPropagation(),this.toggleFps()),e.code==="KeyC"&&(e.preventDefault(),e.stopPropagation(),this.toggleOverlay()))},{passive:!1})}toggleOverlay(e){this.open=typeof e=="boolean"?e:!this.open,this.overlayEl&&(this.overlayEl.style.display=this.open?"flex":"none")}toggleFps(){this.fpsEnabled=!this.fpsEnabled,this.fpsEl&&(this.fpsEl.style.display=this.fpsEnabled?"block":"none")}startFpsLoop(){this.boundLoop||(this.fpsEl=document.getElementById("fps-counter")||this.createFloatingFps(),this.fpsEl.style.display="none",this.boundLoop=e=>{if(this.frames++,e-this.lastFpsSample>1e3){const t=this.frames*1e3/(e-this.lastFpsSample);this.frames=0,this.lastFpsSample=e,this.smoothFps=this.smoothFps?this.smoothFps*.7+t*.3:t,this.fpsEnabled&&(this.fpsEl.textContent="FPS: "+this.smoothFps.toFixed(0))}requestAnimationFrame(this.boundLoop)},requestAnimationFrame(this.boundLoop))}createFloatingFps(){const e=document.createElement("div");return e.id="fps-counter",e.textContent="FPS: --",e.style.position="fixed",e.style.top="58px",e.style.right="12px",e.style.zIndex="1000",e.style.font="12px Roboto, monospace",e.style.padding="4px 8px",e.style.background="rgba(0,0,0,0.4)",e.style.border="1px solid rgba(0,255,106,0.35)",e.style.borderRadius="6px",e.style.color="var(--accent)",document.body.appendChild(e),e}setupConfigForm(){if(!this.overlayEl)return;const e=this.overlayEl.querySelector("#config-form");e&&(e.querySelectorAll("[data-bound]").forEach(t=>{t.dataset.bound=""}),e.querySelectorAll("input[type=range][data-val]").forEach(t=>{if(!t.parentElement.querySelector(".val")){const n=document.createElement("span");n.className="val",n.textContent=t.value,t.parentElement.appendChild(n)}if(!t.dataset.bound){const n=t.parentElement.querySelector(".val");t.addEventListener("input",()=>{n.textContent=t.value,this.applyChange(t.name,t.value)}),t.dataset.bound="1"}}),e.querySelectorAll("input[type=color]").forEach(t=>{t.dataset.bound||(t.addEventListener("input",()=>this.applyChange(t.name,t.value)),t.dataset.bound="1")}),e.querySelectorAll("input[type=checkbox]").forEach(t=>{t.dataset.bound||(t.addEventListener("change",()=>this.applyChange(t.name,t.checked)),t.dataset.bound="1")}),e.querySelectorAll("select").forEach(t=>{t.dataset.bound||(t.addEventListener("change",()=>this.applyChange(t.name,t.value)),t.dataset.bound="1")}),e.querySelectorAll("input[type=number]").forEach(t=>{t.dataset.bound||(t.addEventListener("input",()=>this.applyChange(t.name,parseFloat(t.value))),t.dataset.bound="1")}))}applyChange(e,t){const n=f.getOnChangeHandler();n&&n(e,t)}ensureOverlayElement(){if(this.overlayEl)return;const e=document.createElement("div");e.id="config-overlay",e.innerHTML=this.overlayHTML(),document.body.appendChild(e),this.overlayEl=e;const t=e.querySelector("[data-close]");t&&t.addEventListener("click",()=>this.toggleOverlay(!1)),e.style.display="none"}overlayHTML(){return`
      <div class="config-header">
        <h3>${this.title}</h3>
        <div class="buttons">
          <button data-close title="Close (Alt+C)">âœ•</button>
        </div>
      </div>
      <div class="config-scroll">
        <form id="config-form" autocomplete="off">
          <div id="config-content">
            <!-- Dynamic content will be inserted here -->
          </div>
          <div class="foot">Hotkeys: <kbd>Alt+C</kbd> config, <kbd>Alt+P</kbd> FPS</div>
        </form>
      </div>
    `}}const u=new x;function v(c){u.init(),u.configure(c)}function C(c,e,t={}){return f.registerModule(c,e,t),f}function E(){u.updateOverlayContent(),u.setupConfigForm()}const y="config-style",g=`/* Generic Config Overlay (update-safe) */
#config-overlay{position:fixed;top:0;left:0;display:flex;align-items:stretch;justify-content:flex-start;pointer-events:none;z-index:1500;font:16px Roboto,system-ui,sans-serif;line-height:1.25;}
#config-overlay .config-scroll{width:360px;max-width:92vw;height:100vh;overflow:auto;background:#121212f2;border-right:1px solid rgba(0,255,106,0.4);box-shadow:8px 0 28px -6px rgba(0,0,0,0.7);padding:22px 20px 92px;pointer-events:auto;}
#config-overlay h3{margin:0;font-weight:600;letter-spacing:.85px;color:var(--accent);font-size:21px;text-shadow:0 0 10px rgba(0,255,106,.65);}
#config-overlay fieldset{border:1px solid rgba(0,255,106,0.28);border-radius:12px;margin:16px 0 26px;padding:14px 16px 16px;display:flex;flex-direction:column;gap:14px;}
#config-overlay legend{padding:0 9px;font-size:14px;letter-spacing:.75px;color:var(--accent-soft);}
#config-overlay label{display:flex;flex-direction:column;gap:6px;font-size:14px;color:var(--text-dim);}
#config-overlay input[type=range]{width:100%;}
#config-overlay .val{font-family:monospace;color:var(--accent);font-size:13px;}
#config-overlay .config-header{position:fixed;top:0;left:0;width:360px;display:flex;align-items:center;justify-content:space-between;padding:16px 20px 14px;background:linear-gradient(180deg,#141414,#121212cc);box-shadow:0 4px 12px -6px rgba(0,0,0,0.55);pointer-events:auto;}
#config-overlay .buttons button{background:#161616;border:1px solid rgba(0,255,106,0.6);color:var(--accent);cursor:pointer;font-size:15px;padding:7px 12px;border-radius:8px;line-height:1;transition:background .15s;}
#config-overlay .buttons button:hover{background:#242424;}
#config-overlay form{margin-top:70px;}
#config-overlay .foot{font-size:13px;color:var(--text-dim);margin-top:10px;opacity:.95;}
#config-overlay kbd{background:#222;border:1px solid rgba(255,255,255,0.22);border-radius:5px;padding:3px 6px;font-size:12px;margin:0 2px;box-shadow:0 0 0 1px #000;}
#config-overlay select{width:100%;padding:4px 8px;border:1px solid rgba(0,255,106,0.3);border-radius:4px;background:#161616;color:var(--text-dim);}
#config-overlay input[type=number]{width:100%;padding:4px 8px;border:1px solid rgba(0,255,106,0.3);border-radius:4px;background:#161616;color:var(--text-dim);}
@media (max-width: 680px){#config-overlay .config-scroll{width:94vw;}}`;let l=document.getElementById(y);l?l.textContent!==g&&(l.textContent=g):(l=document.createElement("style"),l.id=y,l.textContent=g,document.head.appendChild(l));export{E as a,v as c,C as r};
