import{r as q,c as K}from"./overlayControls-BYAzFYj-.js";/* empty css              */import{h as W,e as N,M as X,B as Y,d as j}from"./color-D1U2lwmM.js";const e={"ECG Trace Width":{value:4,type:"range",min:.5,max:16,step:.1,label:"Trace Width",section:"ECG Trace"},"ECG Head Size":{value:9,type:"range",min:2,max:28,step:.5,label:"Head Dot Size",section:"ECG Trace"},"ECG Trail Life":{value:55,type:"range",min:5,max:200,step:1,label:"Trail Life (%)",section:"ECG Trace"},"ECG Trace Color":{value:"#00ff6a",type:"color",label:"Trace Color",section:"ECG Trace"},"ECG Grid Size":{value:80,type:"range",min:20,max:160,step:2,label:"Grid Size",section:"ECG Grid"},"ECG Horizontal Padding":{value:5,type:"range",min:0,max:20,step:1,label:"Horizontal Padding (%)",section:"ECG Grid"},"ECG Vertical Padding":{value:4,type:"range",min:0,max:20,step:1,label:"Vertical Padding (%)",section:"ECG Grid"},"ECG Grid Gap":{value:6,type:"range",min:0,max:10,step:1,label:"Grid Gap (%)",section:"ECG Grid"},"ECG Panel Grid Color":{value:"#00ff6a",type:"color",label:"Panel Grid Color",section:"ECG Grid"},"ECG Grid Lines Color":{value:"#00ff6a",type:"color",label:"Grid Lines Color",section:"ECG Grid"},"ECG Show Outer Box":{value:!0,type:"checkbox",label:"Show Outer Box",section:"ECG Grid"},"ECG Show Grid Lines":{value:!0,type:"checkbox",label:"Show Grid Lines",section:"ECG Grid"},"ECG Show Background":{value:!0,type:"checkbox",label:"Show Background",section:"ECG Grid"},"ECG Text Scale":{value:1.2,type:"range",min:.5,max:2,step:.1,label:"Text Scale Factor",section:"ECG Text"},"ECG Text Color":{value:"#00ff6a",type:"color",label:"Text Color",section:"ECG Text"},"ECG Show Counter Prefixes":{value:!0,type:"checkbox",label:"Show Counter Prefixes",section:"ECG Text"},"ECG Show Beats Counter":{value:!0,type:"checkbox",label:"Show Beats Counter",section:"ECG Text"},"ECG Show BPM Counter":{value:!0,type:"checkbox",label:"Show BPM Counter",section:"ECG Text"},"Internal: ECG Sample Resolution":2400,"Internal: ECG Rows":10,"Internal: ECG Cols":8,"Internal: ECG Show BPM Counter":!0,"Internal: ECG Show Rate Counter":!0,"Internal: ECG Show Counter Prefixes":!0};q("config",e,{onChange:(t,o,s)=>{if(["ECG Trace Width","ECG Head Size","ECG Trail Life","ECG Overlap","ECG Trace Color","ECG Grid Size","ECG Horizontal Padding","ECG Vertical Padding","ECG Grid Gap","ECG Panel Grid Color","ECG Grid Lines Color","ECG Show Outer Box","ECG Show Grid Lines","ECG Show Background"].includes(t)){if(!l)return;const n={};t==="ECG Trace Width"?n.lineWidth=o:t==="ECG Head Size"?n.headDotRadius=o:t==="ECG Trail Life"?n.trailLifePercent=o:t==="ECG Trace Color"?(n.colorCore=W(o,.95),l._colorCore=new Float32Array(l.cfg.colorCore)):(t==="ECG Grid Size"||t==="ECG Horizontal Padding"||t==="ECG Vertical Padding"||t==="ECG Grid Gap"||t==="ECG Panel Grid Color"||t==="ECG Grid Lines Color"||t==="ECG Show Outer Box"||t==="ECG Show Grid Lines"||t==="ECG Show Background")&&(w&&w(),d&&d(),b()),Object.keys(n).length>0&&l.updateConfig(n);return}if(t==="ECG Text Scale")b(),d&&setTimeout(()=>d(),50);else if(t==="ECG Text Color"){document.documentElement.style.setProperty("--overlay-text-color",o);const n=document.getElementById("data-counter");n&&(n.style.color=o)}else if((t==="ECG Show Counter Prefixes"||t==="ECG Show Beats Counter"||t==="ECG Show BPM Counter")&&overlayLayer){overlayLayer.innerHTML="",u.length=0;for(let n=0;n<e["Internal: ECG Rows"]*e["Internal: ECG Cols"];n++){const G=document.createElement("div");G.className="cell-overlay";const p=e["ECG Show Counter Prefixes"].value?"Beats: ":"",m=e["ECG Show Counter Prefixes"].value?"BPM: ":"",h=e["ECG Show Beats Counter"].value?`<span class="ov beats">${p}0</span>`:"",v=e["ECG Show BPM Counter"].value?`<span class="ov bpm">${m}--</span>`:"";G.innerHTML=h+v,overlayLayer.appendChild(G),u.push(G)}d&&setTimeout(()=>d(),50)}}});document.getElementById("multi-grid");const S=document.getElementById("data-counter");let l=null,x=null,w=null,k=!1,u=[];function R(){const t=document.getElementById("multi-grid");if(!t)return e["ECG Text Scale"].value*18;const o=t.clientWidth/e["Internal: ECG Cols"],s=t.clientHeight/e["Internal: ECG Rows"],c=e["ECG Grid Gap"].value/100,n=o*(1-c),G=s*(1-c),p=Math.min(n,G),h=Math.max(8,Math.min(50,p*.12))*e["ECG Text Scale"].value;return Math.round(h)}function b(){const t=R();document.documentElement.style.setProperty("--overlay-text-size",t+"px");const o=Math.max(10,Math.min(90,t*1.4)),s=document.getElementById("data-counter");s&&(s.style.fontSize=o+"px")}let d=null;function U(){window.innerHeight>window.innerWidth&&(e["Internal: ECG Show BPM Counter"]=!1);const t=window.innerWidth/window.innerHeight;if(t>1.5){const r=t-1.5,a=Math.floor(r/.1)*1;e["ECG Horizontal Padding"].value=5+a}x&&x.stop(),l&&l.dispose();const o=document.getElementById("multi-grid");o.innerHTML="",o.style.flex="1 1 auto",o.style.minHeight="100px",o.style.display="block",o.style.position="relative";const s=document.createElement("canvas"),c=document.createElement("canvas"),n=document.createElement("div");c.style.background="transparent",s.style.position="absolute",c.style.position="absolute",n.style.position="absolute",s.style.top=c.style.top="0",s.style.left=c.style.left="0",s.style.width=c.style.width="100%",s.style.height=c.style.height="100%",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%",n.style.pointerEvents="none",c.style.pointerEvents="none",o.style.position="relative",o.appendChild(s),o.appendChild(c),o.appendChild(n),u.length=0,n.innerHTML="";for(let r=0;r<e["Internal: ECG Rows"]*e["Internal: ECG Cols"];r++){const a=document.createElement("div");a.className="cell-overlay";const E=e["ECG Show Counter Prefixes"].value?"Beats: ":"",i=e["ECG Show Counter Prefixes"].value?"BPM: ":"",y=e["ECG Show Beats Counter"].value?`<span class="ov beats">${E}0</span>`:"",f=e["ECG Show BPM Counter"].value?`<span class="ov bpm">${i}--</span>`:"";a.innerHTML=y+f,n.appendChild(a),u.push(a)}function G(){const r=o.clientWidth||o.offsetWidth,a=o.clientHeight||o.offsetHeight;if(!r||!a)return;r/e["Internal: ECG Cols"],a/e["Internal: ECG Rows"];const E=r*(e["ECG Horizontal Padding"].value/100),i=r*(e["ECG Vertical Padding"].value/100),y=r-2*E,f=a-2*i,T=y/e["Internal: ECG Cols"];f/e["Internal: ECG Rows"];const H=e["ECG Grid Gap"].value/100,I=T*H,L=T*H,_=I*(e["Internal: ECG Cols"]-1),A=L*(e["Internal: ECG Rows"]-1),P=(y-_)/e["Internal: ECG Cols"],B=(f-A)/e["Internal: ECG Rows"];for(let g=0;g<u.length;g++){const V=g%e["Internal: ECG Cols"],$=Math.floor(g/e["Internal: ECG Cols"]),C=u[g],z=Math.max(6,Math.min(16,P*.025)),M=Math.max(4,Math.min(12,B*.02)),D=E+V*(P+I)+z,F=i+$*(B+L)+M;C.style.transform=`translate(${D}px, ${F}px)`,C.style.position="absolute",C.style.zIndex="10",C.style.width=P-2*z+"px",C.style.height=B-2*M+"px",C.style.display="block",C.style.flexDirection="row",C.style.alignItems="center",C.style.gap="0px"}}d=G;function p(){j(s,{rows:e["Internal: ECG Rows"],cols:e["Internal: ECG Cols"],gridSize:e["ECG Grid Size"].value,gridColorMajor:e["ECG Grid Lines Color"].value,gridColorPanel:e["ECG Panel Grid Color"].value,showGridOuterBox:e["ECG Show Outer Box"].value,showGridLines:e["ECG Show Grid Lines"].value,showGridBackground:e["ECG Show Background"].value,gridGapPercent:e["ECG Grid Gap"].value,viewportHorizontalPadding:e["ECG Horizontal Padding"].value/100,viewportVerticalPadding:e["ECG Vertical Padding"].value/100})}p(),w=p,k||(window.addEventListener("resize",()=>{w&&w(),l&&(l.updateDimensions(window.innerWidth,window.innerHeight),l.resize()),d&&d(),b(),document.getElementById("multi-grid")&&window.innerWidth<600&&setTimeout(()=>{d&&d()},100)}),k=!0),l=new X(c,{rows:e["Internal: ECG Rows"],cols:e["Internal: ECG Cols"],trailLifePercent:e["ECG Trail Life"].value,lineWidth:e["ECG Trace Width"].value,glow:!1,colorCore:W(e["ECG Trace Color"].value,.95),viewportHorizontalPadding:e["ECG Horizontal Padding"].value/100,viewportVerticalPadding:e["ECG Vertical Padding"].value/100,heartRateMode:"auto",gridSize:e["ECG Grid Size"].value,showGrid:e["ECG Show Outer Box"].value||e["ECG Show Grid Lines"].value,gridColor:e["ECG Grid Lines Color"].value,renderWidth:window.innerWidth,renderHeight:window.innerHeight}),x=new Y(l),x.start(),d&&d();const m=R();document.documentElement.style.setProperty("--overlay-text-size",m+"px"),document.documentElement.style.setProperty("--overlay-text-color",e["ECG Text Color"].value),b();let h=0;function v(r){if(l&&r-h>60){h=r,S.textContent=`Total Beats: ${l.totalBeats().toLocaleString()}`;for(let a=0;a<l.traces.length&&a<u.length;a++){const E=l.traces[a],i=u[a];i._bpmEl||(i._bpmEl=i.querySelector(".bpm"),i._beatsEl=i.querySelector(".beats"));const y=e["ECG Show Counter Prefixes"].value?"Beats: ":"",f=e["ECG Show Counter Prefixes"].value?"BPM: ":"";i._beatsEl&&(e["ECG Show Beats Counter"].value?(i._beatsEl.style.display="inline",i._beatsEl.textContent=y+E.beatCount):i._beatsEl.style.display="none"),i._bpmEl&&(e["ECG Show BPM Counter"].value?(i._bpmEl.style.display="inline",i._bpmEl.textContent=f+Math.round(E.heartRate)):i._bpmEl.style.display="none")}}requestAnimationFrame(v)}requestAnimationFrame(v),K({title:"Multi-ECG Configuration"})}N({sampleResolution:e["Internal: ECG Sample Resolution"]}).then(()=>{S.textContent="Total Beats: 0",S.style.color=e["ECG Text Color"].value,U(),document.addEventListener("keydown",t=>{(t.key==="r"||t.key==="R")&&O()})});function O(){if(!(!l||!l.traces)){for(const t of l.traces)t.beatCount=0;S.textContent=`Total Beats: ${l.totalBeats().toLocaleString()}`}}window.addEventListener("message",t=>{t.data==="reset"&&O()});document.addEventListener("keydown",t=>{t.altKey&&(t.key==="ArrowLeft"||t.key==="ArrowRight")&&window.parent.postMessage({type:"keydown",key:t.key,altKey:t.altKey},"*")});
