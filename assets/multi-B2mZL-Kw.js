import{r as K,c as N}from"./overlayControls-BYAzFYj-.js";/* empty css              */import{h as R,e as X,M as Y,B as j,d as U}from"./color-D1U2lwmM.js";const e={"ECG Trace Width":{value:4,type:"range",min:.5,max:16,step:.1,label:"Trace Width",section:"ECG Trace"},"ECG Head Size":{value:9,type:"range",min:2,max:28,step:.5,label:"Head Dot Size",section:"ECG Trace"},"ECG Trail Life":{value:55,type:"range",min:5,max:200,step:1,label:"Trail Life (%)",section:"ECG Trace"},"ECG Trace Color":{value:"#00ff6a",type:"color",label:"Trace Color",section:"ECG Trace"},"ECG Grid Size":{value:80,type:"range",min:20,max:160,step:2,label:"Grid Size",section:"ECG Grid"},"ECG Horizontal Padding":{value:5,type:"range",min:0,max:20,step:1,label:"Horizontal Padding (%)",section:"ECG Grid"},"ECG Vertical Padding":{value:4,type:"range",min:0,max:20,step:1,label:"Vertical Padding (%)",section:"ECG Grid"},"ECG Grid Gap":{value:6,type:"range",min:0,max:10,step:1,label:"Grid Gap (%)",section:"ECG Grid"},"ECG Panel Grid Color":{value:"#00ff6a",type:"color",label:"Panel Grid Color",section:"ECG Grid"},"ECG Grid Lines Color":{value:"#00ff6a",type:"color",label:"Grid Lines Color",section:"ECG Grid"},"ECG Show Outer Box":{value:!0,type:"checkbox",label:"Show Outer Box",section:"ECG Grid"},"ECG Show Grid Lines":{value:!0,type:"checkbox",label:"Show Grid Lines",section:"ECG Grid"},"ECG Show Background":{value:!0,type:"checkbox",label:"Show Background",section:"ECG Grid"},"ECG Text Scale":{value:1.2,type:"range",min:.5,max:2,step:.1,label:"Text Scale Factor",section:"ECG Text"},"ECG Text Color":{value:"#00ff6a",type:"color",label:"Text Color",section:"ECG Text"},"Show Counter Prefixes":{value:!0,type:"checkbox",label:"Show Counter Prefixes",section:"ECG Text"},"Beats Counter":{value:!0,type:"checkbox",label:"Beats Counter",section:"ECG Text"},"BPM Display":{value:!1,type:"checkbox",label:"BPM Display",section:"ECG Text"},"Internal: ECG Sample Resolution":2400,"Internal: ECG Rows":10,"Internal: ECG Cols":8};K("config",e,{onChange:(t,l,s)=>{if(["ECG Trace Width","ECG Head Size","ECG Trail Life","ECG Overlap","ECG Trace Color","ECG Grid Size","ECG Horizontal Padding","ECG Vertical Padding","ECG Grid Gap","ECG Panel Grid Color","ECG Grid Lines Color","ECG Show Outer Box","ECG Show Grid Lines","ECG Show Background"].includes(t)){if(!n)return;const o={};t==="ECG Trace Width"?o.lineWidth=l:t==="ECG Head Size"?o.headDotRadius=l:t==="ECG Trail Life"?o.trailLifePercent=l:t==="ECG Trace Color"?(o.colorCore=R(l,.95),n._colorCore=new Float32Array(n.cfg.colorCore)):(t==="ECG Grid Size"||t==="ECG Horizontal Padding"||t==="ECG Vertical Padding"||t==="ECG Grid Gap"||t==="ECG Panel Grid Color"||t==="ECG Grid Lines Color"||t==="ECG Show Outer Box"||t==="ECG Show Grid Lines"||t==="ECG Show Background")&&(m&&m(),d&&d(),P()),Object.keys(o).length>0&&n.updateConfig(o);return}if(t==="ECG Text Scale")P(),d&&setTimeout(()=>d(),50);else if(t==="ECG Text Color"){document.documentElement.style.setProperty("--overlay-text-color",l);const o=document.getElementById("data-counter");o&&(o.style.color=l)}else if((t==="Show Counter Prefixes"||t==="Beats Counter"||t==="BPM Display")&&b){b.innerHTML="",G.length=0;for(let o=0;o<e["Internal: ECG Rows"]*e["Internal: ECG Cols"];o++){const u=document.createElement("div");u.className="cell-overlay";const p=e["Show Counter Prefixes"].value?"Beats: ":"",v=e["Show Counter Prefixes"].value?"BPM: ":"",y=e["Beats Counter"].value?`<span class="ov beats">${p}0</span>`:"",w=e["BPM Display"].value?`<span class="ov bpm">${v}--</span>`:"";u.innerHTML=y+w,b.appendChild(u),G.push(u)}d&&setTimeout(()=>d(),50)}}});document.getElementById("multi-grid");const S=document.getElementById("data-counter");let n=null,x=null,b=null,m=null,W=!1,G=[];function O(){const t=document.getElementById("multi-grid");if(!t)return e["ECG Text Scale"].value*18;const l=t.clientWidth/e["Internal: ECG Cols"],s=t.clientHeight/e["Internal: ECG Rows"],c=e["ECG Grid Gap"].value/100,o=l*(1-c),u=s*(1-c),p=Math.min(o,u),y=Math.max(8,Math.min(50,p*.12))*e["ECG Text Scale"].value;return Math.round(y)}function P(){const t=O();document.documentElement.style.setProperty("--overlay-text-size",t+"px");const l=Math.max(10,Math.min(90,t*1.4)),s=document.getElementById("data-counter");s&&(s.style.fontSize=l+"px")}let d=null;function J(){window.innerHeight>window.innerWidth&&(e["BPM Display"].value=!1);const t=window.innerWidth/window.innerHeight;if(t>1.5){const r=t-1.5,a=Math.floor(r/.1)*1;e["ECG Horizontal Padding"].value=5+a}x&&x.stop(),n&&n.dispose();const l=document.getElementById("multi-grid");l.innerHTML="",l.style.flex="1 1 auto",l.style.minHeight="100px",l.style.display="block",l.style.position="relative";const s=document.createElement("canvas"),c=document.createElement("canvas"),o=document.createElement("div");c.style.background="transparent",s.style.position="absolute",c.style.position="absolute",o.style.position="absolute",s.style.top=c.style.top="0",s.style.left=c.style.left="0",s.style.width=c.style.width="100%",s.style.height=c.style.height="100%",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.pointerEvents="none",c.style.pointerEvents="none",l.style.position="relative",l.appendChild(s),l.appendChild(c),l.appendChild(o),G.length=0,o.innerHTML="";for(let r=0;r<e["Internal: ECG Rows"]*e["Internal: ECG Cols"];r++){const a=document.createElement("div");a.className="cell-overlay";const E=e["Show Counter Prefixes"].value?"Beats: ":"",i=e["Show Counter Prefixes"].value?"BPM: ":"",f=e["Beats Counter"].value?`<span class="ov beats">${E}0</span>`:"",h=e["BPM Display"].value?`<span class="ov bpm">${i}--</span>`:"";a.innerHTML=f+h,o.appendChild(a),G.push(a)}function u(){const r=l.clientWidth||l.offsetWidth,a=l.clientHeight||l.offsetHeight;if(!r||!a)return;r/e["Internal: ECG Cols"],a/e["Internal: ECG Rows"];const E=r*(e["ECG Horizontal Padding"].value/100),i=r*(e["ECG Vertical Padding"].value/100),f=r-2*E,h=a-2*i,H=f/e["Internal: ECG Cols"];h/e["Internal: ECG Rows"];const z=e["ECG Grid Gap"].value/100,L=H*z,I=H*z,_=L*(e["Internal: ECG Cols"]-1),A=I*(e["Internal: ECG Rows"]-1),B=(f-_)/e["Internal: ECG Cols"],T=(h-A)/e["Internal: ECG Rows"];for(let g=0;g<G.length;g++){const V=g%e["Internal: ECG Cols"],$=Math.floor(g/e["Internal: ECG Cols"]),C=G[g],M=Math.max(6,Math.min(16,B*.025)),k=Math.max(4,Math.min(12,T*.02)),F=E+V*(B+L)+M,q=i+$*(T+I)+k;C.style.transform=`translate(${F}px, ${q}px)`,C.style.position="absolute",C.style.zIndex="10",C.style.width=B-2*M+"px",C.style.height=T-2*k+"px",C.style.display="block",C.style.flexDirection="row",C.style.alignItems="center",C.style.gap="0px"}}d=u;function p(){U(s,{rows:e["Internal: ECG Rows"],cols:e["Internal: ECG Cols"],gridSize:e["ECG Grid Size"].value,gridColorMajor:e["ECG Grid Lines Color"].value,gridColorPanel:e["ECG Panel Grid Color"].value,showGridOuterBox:e["ECG Show Outer Box"].value,showGridLines:e["ECG Show Grid Lines"].value,showGridBackground:e["ECG Show Background"].value,gridGapPercent:e["ECG Grid Gap"].value,viewportHorizontalPadding:e["ECG Horizontal Padding"].value/100,viewportVerticalPadding:e["ECG Vertical Padding"].value/100})}p(),m=p,b=o,W||(window.addEventListener("resize",()=>{m&&m(),n&&(n.updateDimensions(window.innerWidth,window.innerHeight),n.resize()),d&&d(),P(),document.getElementById("multi-grid")&&window.innerWidth<600&&setTimeout(()=>{d&&d()},100)}),W=!0),n=new Y(c,{rows:e["Internal: ECG Rows"],cols:e["Internal: ECG Cols"],trailLifePercent:e["ECG Trail Life"].value,lineWidth:e["ECG Trace Width"].value,glow:!1,colorCore:R(e["ECG Trace Color"].value,.95),viewportHorizontalPadding:e["ECG Horizontal Padding"].value/100,viewportVerticalPadding:e["ECG Vertical Padding"].value/100,heartRateMode:"auto",gridSize:e["ECG Grid Size"].value,showGrid:e["ECG Show Outer Box"].value||e["ECG Show Grid Lines"].value,gridColor:e["ECG Grid Lines Color"].value,renderWidth:window.innerWidth,renderHeight:window.innerHeight}),x=new j(n),x.start(),d&&d();const v=O();document.documentElement.style.setProperty("--overlay-text-size",v+"px"),document.documentElement.style.setProperty("--overlay-text-color",e["ECG Text Color"].value),P();let y=0;function w(r){if(n&&r-y>60){y=r,S.textContent=`Total Beats: ${n.totalBeats().toLocaleString()}`;for(let a=0;a<n.traces.length&&a<G.length;a++){const E=n.traces[a],i=G[a];i._bpmEl||(i._bpmEl=i.querySelector(".bpm"),i._beatsEl=i.querySelector(".beats"));const f=e["Show Counter Prefixes"].value?"Beats: ":"",h=e["Show Counter Prefixes"].value?"BPM: ":"";i._beatsEl&&(e["Beats Counter"].value?(i._beatsEl.style.display="inline",i._beatsEl.textContent=f+E.beatCount):i._beatsEl.style.display="none"),i._bpmEl&&(e["BPM Display"].value?(i._bpmEl.style.display="inline",i._bpmEl.textContent=h+Math.round(E.heartRate)):i._bpmEl.style.display="none")}}requestAnimationFrame(w)}requestAnimationFrame(w),N({title:"Multi-ECG Configuration"})}X({sampleResolution:e["Internal: ECG Sample Resolution"]}).then(()=>{S.textContent="Total Beats: 0",S.style.color=e["ECG Text Color"].value,J(),document.addEventListener("keydown",t=>{(t.key==="r"||t.key==="R")&&D()})});function D(){if(!(!n||!n.traces)){for(const t of n.traces)t.beatCount=0;S.textContent=`Total Beats: ${n.totalBeats().toLocaleString()}`}}window.addEventListener("message",t=>{t.data==="reset"&&D()});document.addEventListener("keydown",t=>{t.altKey&&(t.key==="ArrowLeft"||t.key==="ArrowRight")&&window.parent.postMessage({type:"keydown",key:t.key,altKey:t.altKey},"*")});
