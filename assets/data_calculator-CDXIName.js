import{r as b,c as T}from"./overlayControls-CFepzlKg.js";/* empty css              */import{S as B,C as R,O as P,W as k,a as M}from"./signalSquare-Bn1rA2Su.js";const o={Beds:{value:57,type:"range",min:1,max:1e3,step:1,label:"Number of Beds"},"Average Signals Per Bed":{value:7,type:"range",min:1,max:20,step:1,label:"Average Signals per Bed"},"Sample Rate":{value:250,type:"range",min:1,max:1e4,step:10,label:"Sample Rate (Hz)"},"Particle Base Size":{value:4,type:"range",min:.5,max:25,step:.5,label:"Base Particle Size (px)"},"Particle Size Variation":{value:.5,type:"range",min:0,max:.99,step:.01,label:"Size Variation (Â± proportion)"},"Particle Base Opacity":{value:1,type:"range",min:.1,max:1,step:.1,label:"Base Particle Opacity"},"Particle Glow Intensity":{value:0,type:"range",min:0,max:1,step:.1,label:"Glow Intensity"},"Show Time Breakdown":{value:!0,type:"checkbox",label:"Show Time Breakdown"},"Enable Particles":{value:!1,type:"checkbox",label:"Enable Particle Effects"},"Show Signal Grid":{value:!0,type:"checkbox",label:"Show Signal Grid"},"Internal: Min Signals Per Bed":1,"Internal: Max Signals Per Bed":10,"Internal: Signal Mode":"single","Internal: Signal Rate 2 BPM":26,"Internal: Initial Heart Rate":62,"Internal: Signal A Offsets":[.1,.2,.3,.4],"Internal: Signal B Offset":50,"Internal: Signal CF Offsets":[.15,.3,.45,.6],"Internal: Signal CF Individual Offsets":[150,300,450,600],"Internal: Showcase Start Date":new Date(2025,8,25,10,0,0),"Internal: All Time Start Date":new Date(2024,9,1,0,0,0)};b("config",o,{onChange:(l,t,e)=>{if(l==="Beds"||l==="Average Signals Per Bed"){window.dataCalculator&&window.dataCalculator.generateBeds();return}if(l.startsWith("Particle")){window.dataCalculator&&(window.dataCalculator.config.particleBaseSize=o["Particle Base Size"].value,window.dataCalculator.config.particleSizeVariation=o["Particle Size Variation"].value,window.dataCalculator.config.particleBaseOpacity=o["Particle Base Opacity"].value,window.dataCalculator.config.particleGlowIntensity=o["Particle Glow Intensity"].value);return}if(l==="Sample Rate"){window.dataCalculator&&(window.dataCalculator.config.sampleRate=t);return}if(l==="Show Time Breakdown"){window.dataCalculator&&(window.dataCalculator.showTimeBreakdown=t,window.dataCalculator.updateTimeBreakdownDisplay());return}if(l==="Enable Particles"){window.dataCalculator&&(window.dataCalculator.particlesEnabled=t);return}if(l==="Show Signal Grid"){if(window.dataCalculator){const i=window.dataCalculator.elements.signalGridContainer;i&&(i.style.display=t?"block":"none")}return}}});T({title:"Data Calculator Configuration"});class E{constructor(t,e,i,a=4,s=1,r=.5,n=0){this.canvas=t,this.targetX=e,this.targetY=i,this.baseOpacity=s,this.glowIntensity=n;const d=300,c=window.innerWidth,h=window.innerHeight,m=c/2,p=h/2,u=c/2+d,g=h/2+d,f=Math.random()*Math.PI*2;this.x=m+u*Math.cos(f),this.y=p+g*Math.sin(f),this.speed=200+Math.random()*100,this.life=this.baseOpacity,this.fadeStartDistance=500,this.targetRadius=150,this.fadeRange=this.fadeStartDistance-this.targetRadius;const y=1+(Math.random()-.5)*2*r;if(this.size=a*y,n>0){const w=Math.min(this.size*3,25);this.glowSizes=[Math.min(this.size*1.2,w*.4),Math.min(this.size*1.5,w*.6),Math.min(this.size*2,w)],this.glowAlphas=[n*.25,n*.5,n*.75]}}update(t){const e=this.targetX-this.x,i=this.targetY-this.y,a=e*e+i*i,s=Math.sqrt(a);if(s<this.targetRadius)return!0;if(s<this.fadeStartDistance){const m=Math.max(0,(s-this.targetRadius)/this.fadeRange);this.life=m*this.baseOpacity}else this.life=this.baseOpacity;const r=s>this.fadeStartDistance?1:s/this.fadeStartDistance,n=this.speed*r,d=1/s,c=e*d*n*t,h=i*d*n*t;return this.x+=c,this.y+=h,!1}draw(t){if(!(this.life<=.001)){if(t.save(),t.fillStyle="#23cd3c",this.glowIntensity>0&&this.glowSizes)for(let e=0;e<3;e++)t.globalAlpha=this.life*this.glowAlphas[e],t.beginPath(),t.arc(this.x,this.y,this.glowSizes[e],0,Math.PI*2),t.fill();t.globalAlpha=this.life,t.beginPath(),t.arc(this.x,this.y,this.size,0,Math.PI*2),t.fill(),t.restore()}}}class z{constructor(){this.showTimeBreakdown=o["Show Time Breakdown"].value,this.currentStartTime="page-load",this.totalSignals=0,this.pageLoadTime=performance.now()/1e3,this.startTimeOffsets=this.calculateTimeOffsets(),this.elements={totalSeconds:document.getElementById("total-seconds"),totalValues:document.getElementById("total-values"),timeBreakdown:document.getElementById("time-breakdown"),startTimeSlider:document.getElementById("start-time-slider"),sliderLabels:document.querySelectorAll(".slider-label"),signalGridContainer:document.getElementById("signal-grid-container")},this.mainContainer=document.querySelector(".data-calculator-container"),this.signalRenderer=null,this.scene=null,this.camera=null,this.renderer=null,this.squares=[],this.particleCanvas=document.getElementById("particle-canvas"),this.particleCtx=this.particleCanvas.getContext("2d"),this.particles=[],this.lastSecondsValue=0,this.particlesEnabled=o["Enable Particles"].value,this.canvasWidth=this.particleCanvas.width,this.canvasHeight=this.particleCanvas.height,this.frameCount=0,this.lastFpsUpdate=performance.now(),this.currentFps=60,this.initialize()}initialize(){this.setupCanvas(),this.generateBeds(),this.setupEventListeners(),this.initializeSlider(),this.setupSignalGrid(),this.elements.signalGridContainer&&(this.elements.signalGridContainer.style.display=o["Show Signal Grid"].value?"block":"none"),this.startRealTimeUpdates()}setupCanvas(){const t=()=>{this.particleCanvas.width=window.innerWidth,this.particleCanvas.height=window.innerHeight,this.canvasWidth=this.particleCanvas.width,this.canvasHeight=this.particleCanvas.height};t(),window.addEventListener("resize",t)}calculateTimeOffsets(){const t=new Date,e=new Date(t.getTime());return{"page-load":0,"showcase-start":(e.getTime()-o["Internal: Showcase Start Date"].getTime())/1e3,"all-time":(e.getTime()-o["Internal: All Time Start Date"].getTime())/1e3}}setupEventListeners(){this.elements.startTimeSlider.addEventListener("input",t=>{const e=parseInt(t.target.value);this.updateStartTime(e),this.updateSliderLabels(e)}),document.addEventListener("keydown",t=>{(t.key==="t"||t.key==="T")&&this.toggleSignalGrid(),(t.key==="p"||t.key==="P")&&!t.altKey&&this.toggleParticles()}),window.addEventListener("resize",()=>{if(this.renderer&&this.elements.signalGridContainer.style.display!=="none"){const t=this.elements.signalGridContainer.getBoundingClientRect();this.renderer.setSize(t.width,t.height),this.camera.left=-t.width/2,this.camera.right=t.width/2,this.camera.top=t.height/2,this.camera.bottom=-t.height/2,this.camera.updateProjectionMatrix()}})}initializeSlider(){this.elements.startTimeSlider.value=0,this.updateSliderLabels(0)}updateStartTime(t){const e={0:"page-load",1:"showcase-start",2:"all-time"};this.currentStartTime=e[t]}updateSliderLabels(t){this.elements.sliderLabels.forEach(e=>{const i=parseInt(e.dataset.value)===t;e.classList.toggle("active",i)})}spawnParticle(){this.cachedTargetElement||(this.cachedTargetElement=document.getElementById("total-seconds"));let t=window.innerWidth/2,e=window.innerHeight/2;if(this.cachedTargetElement){const a=this.cachedTargetElement.getBoundingClientRect();t=a.left+a.width/2,e=a.top+a.height/2}const i=new E(this.particleCanvas,t,e,o["Particle Base Size"].value,o["Particle Base Opacity"].value,o["Particle Size Variation"].value,o["Particle Glow Intensity"].value);this.particles.push(i)}setupSignalGrid(){if(!this.elements.signalGridContainer)return;const i=this.elements.signalGridContainer.parentElement.getBoundingClientRect().width,a=1.5,s=32,r=17,n=(i-(s-1)*a)/s,c=Math.max(n,8),h=s*(c+a)-a,m=r*(c+a)-a,p=this.elements.signalGridContainer;p.style.width=h+"px",p.style.height=m+"px",this.scene=new B,this.scene.background=new R(855309),this.camera=new P(-h/2,h/2,m/2,-m/2,.1,1e3),this.camera.position.z=10,this.renderer=new k({antialias:!0,powerPreference:"high-performance"}),this.renderer.setSize(h,m),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,3)),this.renderer.setClearColor(855309),p.appendChild(this.renderer.domElement),this.squares=[];for(let u=0;u<r;u++)for(let g=0;g<s;g++){const f=(g-(s-1)/2)*(c+a),y=((r-1)/2-u)*(c+a),w=Math.random()*4,v=1*(1+(Math.random()-.5)*2*.1),S=new M({color:[35/255,205/255,60/255],pulseRate:v,size:c,glowIntensity:.8,edgeSoftness:.3,fadeRate:1.4});S.setPosition(f,y,0),S.timeOffset=w,this.scene.add(S.getMesh()),this.squares.push(S)}this.animateSignalGrid()}animateSignalGrid(){let t=performance.now();const e=this.particleCtx;this.particleCanvas;const i=()=>{requestAnimationFrame(i);const a=performance.now(),s=Math.min((a-t)/1e3,1/30);if(t=a,this.frameCount++,a-this.lastFpsUpdate>=1e3&&(this.currentFps=Math.round(this.frameCount*1e3/(a-this.lastFpsUpdate)),this.frameCount=0,this.lastFpsUpdate=a),this.particles.length>0){e.clearRect(0,0,this.canvasWidth,this.canvasHeight);for(let r=this.particles.length-1;r>=0;r--){const n=this.particles[r];n.update(s)?this.particles.splice(r,1):n.draw(e)}}if(this.elements.signalGridContainer.style.display!=="none"){const r=a;this.squares.forEach(n=>{const d=r+n.timeOffset*1e3;n.update(0,d)}),this.renderer.render(this.scene,this.camera)}};i()}generateBeds(){this.totalSignals=o.Beds.value*o["Average Signals Per Bed"].value}startRealTimeUpdates(){const t=()=>{const i=performance.now()/1e3-this.pageLoadTime,a=this.startTimeOffsets[this.currentStartTime],s=i+a;this.updateCounterDisplay(s),requestAnimationFrame(t)};t()}updateCounterDisplay(t){const i=Math.max(0,t)*this.totalSignals,a=i*o["Sample Rate"].value;if(this.particlesEnabled){const s=Math.floor(i)-Math.floor(this.lastSecondsValue);if(s>0){const r=Math.min(s*2,5);for(let n=0;n<r;n++)this.spawnParticle()}}this.lastSecondsValue=Math.floor(i),this.elements.totalSeconds.textContent=this.formatNumber(Math.floor(i)),this.elements.totalValues.textContent=this.formatNumber(Math.floor(a)),this.updateTimeBreakdownDisplay(i)}updateTimeBreakdownDisplay(t=0){if(o["Show Time Breakdown"].value){const e=this.formatTimeDetailed(t);this.elements.timeBreakdown.textContent=e,this.elements.timeBreakdown.style.display="block"}else this.elements.timeBreakdown.style.display="none"}toggleSignalGrid(){if(this.elements.signalGridContainer){const t=this.elements.signalGridContainer.style.display!=="none";this.elements.signalGridContainer.style.display=t?"none":"block",o["Show Signal Grid"].value=!t}}toggleParticles(){this.particlesEnabled=!this.particlesEnabled,o["Enable Particles"].value=this.particlesEnabled}reset(){this.pageLoadTime=performance.now()/1e3,this.startTimeOffsets=this.calculateTimeOffsets(),this.lastSecondsValue=0,this.particles=[],this.elements.totalSeconds.textContent="0",this.elements.totalValues.textContent="0",this.updateTimeBreakdownDisplay(0)}getFrameRateInfo(){const t=window.screen?.refreshRate||window.screen?.mozRefreshRate||window.screen?.webkitRefreshRate||"unknown";return{currentFps:this.currentFps,displayRefreshRate:t,pixelRatio:window.devicePixelRatio,isHighRefreshRate:t>=120||this.currentFps>=100,deltaTimeCap:"30fps minimum"}}formatNumber(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}formatTimeDetailed(t){const e=Math.floor(t/31557600),i=Math.floor(t%(365.25*24*60*60)/(30.44*24*60*60)),a=Math.floor(t%(30.44*24*60*60)/(1440*60)),s=Math.floor(t%(1440*60)/3600),r=Math.floor(t%3600/60),n=Math.floor(t%60),d=[];let c="seconds";switch(e>=1?c="years":i>=1?c="months":a>=1?c="days":s>=1?c="hours":r>=1&&(c="minutes"),c){case"years":d.push(`${e}y`,`${i.toString().padStart(2,"0")}mo`,`${a.toString().padStart(2,"0")}d`,`${s.toString().padStart(2,"0")}h`,`${r.toString().padStart(2,"0")}m`,`${n.toString().padStart(2,"0")}s`);break;case"months":d.push(`${i.toString().padStart(2,"0")}mo`,`${a.toString().padStart(2,"0")}d`,`${s.toString().padStart(2,"0")}h`,`${r.toString().padStart(2,"0")}m`,`${n.toString().padStart(2,"0")}s`);break;case"days":d.push(`${a.toString().padStart(2,"0")}d`,`${s.toString().padStart(2,"0")}h`,`${r.toString().padStart(2,"0")}m`,`${n.toString().padStart(2,"0")}s`);break;case"hours":d.push(`${s.toString().padStart(2,"0")}h`,`${r.toString().padStart(2,"0")}m`,`${n.toString().padStart(2,"0")}s`);break;case"minutes":d.push(`${r.toString().padStart(2,"0")}m`,`${n.toString().padStart(2,"0")}s`);break;default:d.push(`${n.toString().padStart(2,"0")}s`);break}return d.join(" ")}}document.addEventListener("DOMContentLoaded",()=>{window.dataCalculator=new z,window.getFrameRateInfo=()=>window.dataCalculator?window.dataCalculator.getFrameRateInfo():{error:"DataCalculator not initialized"}});function C(){window.dataCalculator&&window.dataCalculator.reset()}document.addEventListener("keydown",l=>{(l.key==="r"||l.key==="R")&&C()});window.addEventListener("message",l=>{l.data==="reset"&&C()});document.addEventListener("keydown",l=>{l.ctrlKey&&(l.key==="ArrowLeft"||l.key==="ArrowRight")&&window.parent.postMessage({type:"keydown",key:l.key,ctrlKey:l.ctrlKey},"*")});
