import{i as I,e as y,M as x,B as C}from"./overlayControls-Cy_o3L__.js";/* empty css              */function h(t,n){let r=t.replace("#","");r.length===3&&(r=r.split("").map(s=>s+s).join(""));const a=parseInt(r.substring(0,2),16),e=parseInt(r.substring(2,4),16),i=parseInt(r.substring(4,6),16);return`rgba(${a},${e},${i},${n})`}function S(t,n,r,a){const e=t.getContext("2d");if(!e)return;const i=t.clientWidth||t.width,s=t.clientHeight||t.height,c=window.devicePixelRatio||1;(t.width!==i*c||t.height!==s*c)&&(t.width=i*c,t.height=s*c,t.style.width=i+"px",t.style.height=s+"px"),e.setTransform(c,0,0,c,0,0),e.clearRect(0,0,i,s);const m=n,_=m/5;e.lineWidth=1,e.strokeStyle=h(a,.06),e.beginPath();for(let l=0;l<i;l+=_)e.moveTo(l,0),e.lineTo(l,s);for(let l=0;l<s;l+=_)e.moveTo(0,l),e.lineTo(i,l);e.stroke(),e.strokeStyle=h(r,.14),e.beginPath();for(let l=0;l<i;l+=m)e.moveTo(l,0),e.lineTo(l,s);for(let l=0;l<s;l+=m)e.moveTo(0,l),e.lineTo(i,l);e.stroke()}const o={OVERLAP_PERCENT:15,TRAIL_LIFE_PERCENT:65,GRID_SIZE:50,CORE_WIDTH:4,COLORS:{gridMajor:"#00ff6a",gridMinor:"#00ff6a"},SHOW_GRID:!0,SAMPLE_RESOLUTION:3200,OVERLAY_TEXT_SIZE:18,OVERLAY_TEXT_COLOR:"#00ff6a",OVERLAY_TEXT_GLOW:8,TOTAL_BEATS_SIZE:22},u=document.getElementById("single-grid-canvas"),A=document.getElementById("single-trace-canvas"),O=document.getElementById("single-bpm"),g=document.getElementById("single-beats"),T=document.getElementById("cfg-hr"),b=document.getElementById("val-hr");let E=null,L=null,R=null,d=null;function f(){o.SHOW_GRID&&S(u,o.GRID_SIZE,o.COLORS.gridMajor,o.COLORS.gridMinor)}function $(){y({sampleResolution:o.SAMPLE_RESOLUTION}).then(()=>{E=new x(A,{rows:1,cols:1,overlapPercent:o.OVERLAP_PERCENT,trailLifePercent:o.TRAIL_LIFE_PERCENT,lineWidth:o.CORE_WIDTH,glow:!1,colorCore:[0,1,0,.95]}),L=new C(E),L.start(),R=u.getContext("2d"),o.SHOW_GRID&&f(),d=E.traces[0],O.textContent=Math.round(d.heartRate),g.textContent="0",document.documentElement.style.setProperty("--overlay-text-size",o.OVERLAY_TEXT_SIZE+"px"),document.documentElement.style.setProperty("--overlay-text-color",o.OVERLAY_TEXT_COLOR),document.documentElement.style.setProperty("--overlay-text-shadow",p(o.OVERLAY_TEXT_COLOR,o.OVERLAY_TEXT_GLOW));const t=document.getElementById("data-counter");t&&(t.style.color=o.OVERLAY_TEXT_COLOR);const n=document.getElementById("data-counter");n&&(n.style.fontSize=o.TOTAL_BEATS_SIZE+"px");let r=0;(function a(e){e-r>70&&d&&(r=e,O.textContent=Math.round(d.heartRate),g.textContent=d.beatCount),requestAnimationFrame(a)})(performance.now())})}function G(){T&&T.addEventListener("input",()=>{const t=+T.value;d&&(d.baseHeartRate=t,d.heartRate=t,d.beatInterval=6e4/t,d.driftStart=0),b.textContent=t,O.textContent=t})}G();$();I({batch:()=>E,single:!0,redrawGrid:t=>{o.GRID_SIZE=t,f()},toggleGrid:t=>{o.SHOW_GRID=t,t?f():R&&R.clearRect(0,0,u.width,u.height)},updateText:({size:t,color:n,totalSize:r,glow:a})=>{let e=!1;if(t&&(o.OVERLAY_TEXT_SIZE=t,document.documentElement.style.setProperty("--overlay-text-size",t+"px")),n){o.OVERLAY_TEXT_COLOR=n,document.documentElement.style.setProperty("--overlay-text-color",n);const i=document.getElementById("data-counter");i&&(i.style.color=n),e=!0}if(typeof a=="number"&&(o.OVERLAY_TEXT_GLOW=a,e=!0),e){const i=o.OVERLAY_TEXT_GLOW>0?p(o.OVERLAY_TEXT_COLOR,o.OVERLAY_TEXT_GLOW):"none";document.documentElement.style.setProperty("--overlay-text-shadow",i)}if(r){o.TOTAL_BEATS_SIZE=r;const i=document.getElementById("data-counter");i&&(i.style.fontSize=r+"px")}}});function P(t){let n=t.replace("#","");return n.length===3&&(n=n.split("").map(r=>r+r).join("")),[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function p(t,n){const[r,a,e]=P(t);if(n<=0)return"none";if(n<4)return`0 0 ${n}px rgba(${r},${a},${e},0.65)`;const i=Math.round(n*.4),s=Math.round(n*.75);return`0 0 ${i}px rgba(${r},${a},${e},0.55), 0 0 ${s}px rgba(${r},${a},${e},0.35), 0 0 ${n}px rgba(${r},${a},${e},0.22)`}
