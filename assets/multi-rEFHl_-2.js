import{e as F,M as $,B as q,i as Z}from"./overlayControls-Cy_o3L__.js";/* empty css              */const n={ROWS:10,COLS:8,OVERLAP_PERCENT:15,TRAIL_LIFE_PERCENT:65,GRID_SIZE:42,GRID_COLOR_PANEL:"#00ff6a",GRID_COLOR_MAJOR:"#00ff6a",GRID_COLOR_MINOR:"#00ff6a",OVERLAY_TEXT_SIZE:18,OVERLAY_TEXT_COLOR:"#00ff6a",SAMPLE_RESOLUTION:2400};document.getElementById("multi-grid");const W=document.getElementById("data-counter"),k=document.getElementById("fps-counter");k&&(k.style.display="none");let y=null,S=null,G=null,u=null,Y=!1,O=[];function z(){S&&S.stop(),y&&y.dispose();const l=document.getElementById("multi-grid");l.innerHTML="",l.style.flex="1 1 auto",l.style.minHeight="100px",l.style.display="block",l.style.position="relative";const d=document.createElement("canvas"),i=document.createElement("canvas"),p=document.createElement("div");i.style.background="transparent",d.style.position="absolute",i.style.position="absolute",p.style.position="absolute",d.style.top=i.style.top="0",d.style.left=i.style.left="0",d.style.width=i.style.width="100%",d.style.height=i.style.height="100%",p.style.top="0",p.style.left="0",p.style.width="100%",p.style.height="100%",p.style.pointerEvents="none",i.style.pointerEvents="none",l.style.position="relative",l.appendChild(d),l.appendChild(i),l.appendChild(p),O.length=0,p.innerHTML="";for(let e=0;e<n.ROWS*n.COLS;e++){const o=document.createElement("div");o.className="cell-overlay",o.innerHTML='<span class="ov bpm">BPM: --</span><span class="ov beats">Beat Count: 0</span>',p.appendChild(o),O.push(o)}function D(){const e=l.clientWidth||l.offsetWidth,o=l.clientHeight||l.offsetHeight;if(!e||!o)return;const h=e/n.COLS,t=o/n.ROWS;for(let E=0;E<O.length;E++){const C=E%n.COLS,s=Math.floor(E/n.COLS),r=O[E];r.style.transform=`translate(${C*h+6}px, ${s*t+6}px)`}}function T(){let e=l.clientWidth||l.offsetWidth,o=l.clientHeight||l.offsetHeight;if((e===0||o===0)&&(e=window.innerWidth,o=window.innerHeight-(document.querySelector(".multi-header")?.offsetHeight||0)-10,l.style.width=e+"px",l.style.height=o+"px",e===0||o===0)){requestAnimationFrame(T);return}const h=window.devicePixelRatio||1;d.width=e*h,d.height=o*h,d.style.width=e+"px",d.style.height=o+"px";const t=d.getContext("2d");t.setTransform(h,0,0,h,0,0),t.clearRect(0,0,e,o),t.fillStyle="#0d0d0d",t.fillRect(0,0,e,o);const E=n.COLS,C=n.ROWS,s=e/E,r=o/C,X=n.GRID_SIZE,v=Math.max(1,Math.round(s/X)),x=Math.max(1,Math.round(r/X)),M=s/v,P=r/x,_=5,V=M/_,j=P/_;t.lineWidth=1,t.strokeStyle="rgba(0,255,0,0.05)";for(let w=0;w<C;w++)for(let A=0;A<E;A++){const f=A*s,m=w*r;t.save(),t.beginPath(),t.rect(f,m,s,r),t.clip(),t.strokeStyle=B(n.GRID_COLOR_MINOR,.12),t.lineWidth=1;for(let a=0;a<v;a++)for(let c=1;c<_;c++){const R=f+a*M+c*V;R>=f+s-.5||(t.beginPath(),t.moveTo(R,m),t.lineTo(R,m+r),t.stroke())}for(let a=0;a<x;a++)for(let c=1;c<_;c++){const R=m+a*P+c*j;R>=m+r-.5||(t.beginPath(),t.moveTo(f,R),t.lineTo(f+s,R),t.stroke())}t.strokeStyle=B(n.GRID_COLOR_MAJOR,.12),t.lineWidth=1;for(let a=1;a<v;a++){const c=f+a*M;c>=f+s-.5||(t.beginPath(),t.moveTo(c,m),t.lineTo(c,m+r),t.stroke())}for(let a=1;a<x;a++){const c=m+a*P;c>=m+r-.5||(t.beginPath(),t.moveTo(f,c),t.lineTo(f+s,c),t.stroke())}t.restore();const L=t.createRadialGradient(f+s*.55,m+r*.5,0,f+s*.55,m+r*.5,Math.max(s,r)*.45);L.addColorStop(0,"rgba(0,255,106,0.055)"),L.addColorStop(.45,"rgba(0,255,106,0.015)"),L.addColorStop(1,"rgba(0,255,106,0)"),t.fillStyle=L,t.fillRect(f,m,s,r),t.strokeStyle=B(n.GRID_COLOR_PANEL,.24),t.lineWidth=.75,t.strokeRect(f+.35,m+.35,s-.7,r-.7)}}T(),u=T,G=d,Y||(window.addEventListener("resize",()=>{u&&u(),O.length&&D(),y&&y.resize()}),Y=!0),y=new $(i,{rows:n.ROWS,cols:n.COLS,overlapPercent:n.OVERLAP_PERCENT,trailLifePercent:n.TRAIL_LIFE_PERCENT,lineWidth:4,glow:!1,colorCore:[0,1,0,.9]}),S=new q(y),S.start(),D(),document.documentElement.style.setProperty("--overlay-text-size",n.OVERLAY_TEXT_SIZE+"px"),document.documentElement.style.setProperty("--overlay-text-color",n.OVERLAY_TEXT_COLOR);let I=0,b=performance.now(),g=null,N=0;function H(e){if(I++,e-b>1e3){const o=I*1e3/(e-b);I=0,b=e,g=g?g*.7+o*.3:o,k.textContent=`FPS: ${g.toFixed(0)}`}if(y&&e-N>60){N=e,W.textContent=`Total Beats: ${y.totalBeats().toLocaleString()}`;for(let o=0;o<y.traces.length&&o<O.length;o++){const h=y.traces[o],t=O[o];t._bpmEl||(t._bpmEl=t.querySelector(".bpm"),t._beatsEl=t.querySelector(".beats")),t._bpmEl&&(t._bpmEl.textContent="BPM: "+Math.round(h.heartRate)),t._beatsEl&&(t._beatsEl.textContent="Beat Count: "+h.beatCount)}}requestAnimationFrame(H)}requestAnimationFrame(H),Z({batch:y,single:!1,redrawGrid:e=>{n.GRID_SIZE=e,u&&u()},toggleGrid:e=>{G&&(G.style.display=e?"block":"none")},setGridColorPanel:e=>{n.GRID_COLOR_PANEL=e,u&&u()},setGridColorMajor:e=>{n.GRID_COLOR_MAJOR=e,u&&u()},setGridColorMinor:e=>{n.GRID_COLOR_MINOR=e,u&&u()},updateText:({size:e,color:o,totalSize:h})=>{if(e&&(n.OVERLAY_TEXT_SIZE=e,document.documentElement.style.setProperty("--overlay-text-size",e+"px")),o){n.OVERLAY_TEXT_COLOR=o,document.documentElement.style.setProperty("--overlay-text-color",o);const t=document.getElementById("data-counter");t&&(t.style.color=o)}if(h){const t=document.getElementById("data-counter");t&&(t.style.fontSize=h+"px")}}})}F({sampleResolution:n.SAMPLE_RESOLUTION}).then(()=>{W.textContent="Total Beats: 0",W.style.color=n.OVERLAY_TEXT_COLOR,z()});function B(l,d){let i=l.replace("#","");return i.length===3&&(i=i.split("").map(p=>p+p).join("")),`rgba(${parseInt(i.slice(0,2),16)},${parseInt(i.slice(2,4),16)},${parseInt(i.slice(4,6),16)},${d})`}
