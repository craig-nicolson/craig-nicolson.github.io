import{r as v,c as b}from"./overlayControls-BYAzFYj-.js";/* empty css              */import{S as T,C as B,O as P,W as R,a as M}from"./signalSquare-CzoGnx3u.js";const l={Beds:{value:77,type:"range",min:1,max:1e3,step:1,label:"Number of Beds"},"Average Signals Per Bed":{value:7,type:"range",min:1,max:20,step:1,label:"Average Signals per Bed"},"Sample Rate":{value:250,type:"range",min:1,max:1e4,step:10,label:"Sample Rate (Hz)"},"Particle Base Size":{value:4,type:"range",min:.5,max:25,step:.5,label:"Base Particle Size (px)"},"Particle Size Variation":{value:.5,type:"range",min:0,max:.99,step:.01,label:"Size Variation (Â± proportion)"},"Particle Base Opacity":{value:1,type:"range",min:.1,max:1,step:.1,label:"Base Particle Opacity"},"Particle Glow Intensity":{value:0,type:"range",min:0,max:1,step:.1,label:"Glow Intensity"},"Show Time Breakdown":{value:!0,type:"checkbox",label:"Show Time Breakdown"},"Enable Particles":{value:!1,type:"checkbox",label:"Enable Particle Effects"},"Show Signal Grid":{value:!1,type:"checkbox",label:"Show Signal Grid"},"Internal: Min Signals Per Bed":1,"Internal: Max Signals Per Bed":10,"Internal: Signal Mode":"single","Internal: Signal Rate 2 BPM":26,"Internal: Initial Heart Rate":62,"Internal: Signal A Offsets":[.1,.2,.3,.4],"Internal: Signal B Offset":50,"Internal: Signal CF Offsets":[.15,.3,.45,.6],"Internal: Signal CF Individual Offsets":[150,300,450,600],"Internal: Showcase Start Date":new Date(2025,9,3,23,56,0),"Internal: All Time Start Date":new Date(2024,9,1,0,0,0),"Internal: Showcase Offset Hours":2.5,"Internal: Use Showcase Offset":!1};v("config",l,{onChange:(c,t,e)=>{if(c==="Beds"||c==="Average Signals Per Bed"){window.dataCalculator&&window.dataCalculator.generateBeds();return}if(c.startsWith("Particle")){window.dataCalculator&&(window.dataCalculator.config.particleBaseSize=l["Particle Base Size"].value,window.dataCalculator.config.particleSizeVariation=l["Particle Size Variation"].value,window.dataCalculator.config.particleBaseOpacity=l["Particle Base Opacity"].value,window.dataCalculator.config.particleGlowIntensity=l["Particle Glow Intensity"].value);return}if(c==="Sample Rate"){window.dataCalculator&&(window.dataCalculator.config.sampleRate=t);return}if(c==="Show Time Breakdown"){window.dataCalculator&&(window.dataCalculator.showTimeBreakdown=t,window.dataCalculator.updateTimeBreakdownDisplay());return}if(c==="Enable Particles"){window.dataCalculator&&(window.dataCalculator.particlesEnabled=t);return}if(c==="Show Signal Grid"){if(window.dataCalculator){const a=window.dataCalculator.elements.signalGridContainer;a&&(a.style.display=t?"block":"none")}return}}});b({title:"Data Calculator Configuration"});class I{constructor(t,e,a,i=4,s=1,r=.5,n=0){this.canvas=t,this.targetX=e,this.targetY=a,this.baseOpacity=s,this.glowIntensity=n;const o=300,h=window.innerWidth,d=window.innerHeight,m=h/2,p=d/2,u=h/2+o,g=d/2+o,w=Math.random()*Math.PI*2;this.x=m+u*Math.cos(w),this.y=p+g*Math.sin(w),this.speed=200+Math.random()*100,this.life=this.baseOpacity,this.fadeStartDistance=500,this.targetRadius=150,this.fadeRange=this.fadeStartDistance-this.targetRadius;const C=1+(Math.random()-.5)*2*r;if(this.size=i*C,n>0){const f=Math.min(this.size*3,25);this.glowSizes=[Math.min(this.size*1.2,f*.4),Math.min(this.size*1.5,f*.6),Math.min(this.size*2,f)],this.glowAlphas=[n*.25,n*.5,n*.75]}}update(t){const e=this.targetX-this.x,a=this.targetY-this.y,i=e*e+a*a,s=Math.sqrt(i);if(s<this.targetRadius)return!0;if(s<this.fadeStartDistance){const m=Math.max(0,(s-this.targetRadius)/this.fadeRange);this.life=m*this.baseOpacity}else this.life=this.baseOpacity;const r=s>this.fadeStartDistance?1:s/this.fadeStartDistance,n=this.speed*r,o=1/s,h=e*o*n*t,d=a*o*n*t;return this.x+=h,this.y+=d,!1}draw(t){if(!(this.life<=.001)){if(t.save(),t.fillStyle="#23cd3c",this.glowIntensity>0&&this.glowSizes)for(let e=0;e<3;e++)t.globalAlpha=this.life*this.glowAlphas[e],t.beginPath(),t.arc(this.x,this.y,this.glowSizes[e],0,Math.PI*2),t.fill();t.globalAlpha=this.life,t.beginPath(),t.arc(this.x,this.y,this.size,0,Math.PI*2),t.fill(),t.restore()}}}class z{constructor(){this.showTimeBreakdown=l["Show Time Breakdown"].value,this.currentStartTime="page-load",this.totalSignals=0,this.pageLoadTime=performance.now()/1e3,this.startTimeOffsets=this.calculateTimeOffsets(),this.elements={totalSeconds:document.getElementById("total-seconds"),totalValues:document.getElementById("total-values"),timeBreakdown:document.getElementById("time-breakdown"),startTimeSlider:document.getElementById("start-time-slider"),sliderLabels:document.querySelectorAll(".slider-label"),signalGridContainer:document.getElementById("signal-grid-container")},this.mainContainer=document.querySelector(".data-calculator-container"),this.signalRenderer=null,this.scene=null,this.camera=null,this.renderer=null,this.squares=[],this.particleCanvas=document.getElementById("particle-canvas"),this.particleCtx=this.particleCanvas.getContext("2d"),this.particles=[],this.lastSecondsValue=0,this.particlesEnabled=l["Enable Particles"].value,this.canvasWidth=this.particleCanvas.width,this.canvasHeight=this.particleCanvas.height,this.frameCount=0,this.lastFpsUpdate=performance.now(),this.currentFps=60,this.initialize()}initialize(){this.setupCanvas(),this.generateBeds(),this.setupEventListeners(),this.initializeSlider(),this.setupSignalGrid(),this.elements.signalGridContainer&&(this.elements.signalGridContainer.style.display=l["Show Signal Grid"].value?"block":"none"),this.startRealTimeUpdates()}setupCanvas(){const t=()=>{this.particleCanvas.width=window.innerWidth,this.particleCanvas.height=window.innerHeight,this.canvasWidth=this.particleCanvas.width,this.canvasHeight=this.particleCanvas.height};t(),window.addEventListener("resize",t)}calculateTimeOffsets(){const t=new Date,e=new Date(t.getTime()),a={"page-load":0,"showcase-start":(e.getTime()-l["Internal: Showcase Start Date"].getTime())/1e3,"all-time":(e.getTime()-l["Internal: All Time Start Date"].getTime())/1e3};return a}setupEventListeners(){this.elements.startTimeSlider.addEventListener("input",t=>{const e=parseInt(t.target.value);this.updateStartTime(e),this.updateSliderLabels(e)}),document.addEventListener("keydown",t=>{(t.key==="t"||t.key==="T")&&this.toggleSignalGrid(),(t.key==="p"||t.key==="P")&&!t.altKey&&this.toggleParticles()}),window.addEventListener("resize",()=>{if(this.renderer&&this.elements.signalGridContainer.style.display!=="none"){const t=this.elements.signalGridContainer.getBoundingClientRect();this.renderer.setSize(t.width,t.height),this.camera.left=-t.width/2,this.camera.right=t.width/2,this.camera.top=t.height/2,this.camera.bottom=-t.height/2,this.camera.updateProjectionMatrix()}})}initializeSlider(){this.elements.startTimeSlider.value=0,this.updateSliderLabels(0)}updateStartTime(t){const e={0:"page-load",1:"showcase-start",2:"all-time"};this.currentStartTime=e[t]}updateSliderLabels(t){this.elements.sliderLabels.forEach(e=>{const a=parseInt(e.dataset.value)===t;e.classList.toggle("active",a)})}spawnParticle(){this.cachedTargetElement||(this.cachedTargetElement=document.getElementById("total-seconds"));let t=window.innerWidth/2,e=window.innerHeight/2;if(this.cachedTargetElement){const i=this.cachedTargetElement.getBoundingClientRect();t=i.left+i.width/2,e=i.top+i.height/2}const a=new I(this.particleCanvas,t,e,l["Particle Base Size"].value,l["Particle Base Opacity"].value,l["Particle Size Variation"].value,l["Particle Glow Intensity"].value);this.particles.push(a)}setupSignalGrid(){if(!this.elements.signalGridContainer)return;const a=this.elements.signalGridContainer.parentElement.getBoundingClientRect().width,i=1.5,s=32,r=17,n=(a-(s-1)*i)/s,h=Math.max(n,8),d=s*(h+i)-i,m=r*(h+i)-i,p=this.elements.signalGridContainer;p.style.width=d+"px",p.style.height=m+"px",this.scene=new T,this.scene.background=new B(855309),this.camera=new P(-d/2,d/2,m/2,-m/2,.1,1e3),this.camera.position.z=10,this.renderer=new R({antialias:!0,powerPreference:"high-performance"}),this.renderer.setSize(d,m),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,3)),this.renderer.setClearColor(855309),p.appendChild(this.renderer.domElement),this.squares=[];for(let u=0;u<r;u++)for(let g=0;g<s;g++){const w=(g-(s-1)/2)*(h+i),C=((r-1)/2-u)*(h+i),f=Math.random()*4,y=1*(1+(Math.random()-.5)*2*.1),S=new M({color:[35/255,205/255,60/255],pulseRate:y,size:h,glowIntensity:.8,edgeSoftness:.3,fadeRate:1});S.setPosition(w,C,0),S.timeOffset=f,this.scene.add(S.getMesh()),this.squares.push(S)}this.animateSignalGrid()}animateSignalGrid(){let t=performance.now();const e=this.particleCtx;this.particleCanvas;const a=()=>{requestAnimationFrame(a);const i=performance.now(),s=Math.min((i-t)/1e3,1/30);if(t=i,this.frameCount++,i-this.lastFpsUpdate>=1e3&&(this.currentFps=Math.round(this.frameCount*1e3/(i-this.lastFpsUpdate)),this.frameCount=0,this.lastFpsUpdate=i),this.particles.length>0){e.clearRect(0,0,this.canvasWidth,this.canvasHeight);for(let r=this.particles.length-1;r>=0;r--){const n=this.particles[r];n.update(s)?this.particles.splice(r,1):n.draw(e)}}if(this.elements.signalGridContainer.style.display!=="none"){const r=i/1e3;this.squares.forEach(n=>{const o=r+n.timeOffset;n.update(0,o)}),this.renderer.render(this.scene,this.camera)}};a()}generateBeds(){this.totalSignals=l.Beds.value*l["Average Signals Per Bed"].value}startRealTimeUpdates(){const t=()=>{const a=performance.now()/1e3-this.pageLoadTime,i=this.startTimeOffsets[this.currentStartTime],s=a+i;this.updateCounterDisplay(s),requestAnimationFrame(t)};t()}updateCounterDisplay(t){const a=Math.max(0,t)*this.totalSignals,i=a*l["Sample Rate"].value;if(this.particlesEnabled){const s=Math.floor(a)-Math.floor(this.lastSecondsValue);if(s>0){const r=Math.min(s*2,5);for(let n=0;n<r;n++)this.spawnParticle()}}this.lastSecondsValue=Math.floor(a),this.elements.totalSeconds.textContent=this.formatNumber(Math.floor(a)),this.elements.totalValues.textContent=this.formatNumber(Math.floor(i)),this.updateTimeBreakdownDisplay(a)}updateTimeBreakdownDisplay(t=0){if(l["Show Time Breakdown"].value){const e=this.formatTimeDetailed(t);this.elements.timeBreakdown.textContent=e,this.elements.timeBreakdown.style.display="block"}else this.elements.timeBreakdown.style.display="none"}toggleSignalGrid(){if(this.elements.signalGridContainer){const t=this.elements.signalGridContainer.style.display!=="none";this.elements.signalGridContainer.style.display=t?"none":"block",l["Show Signal Grid"].value=!t}}toggleParticles(){this.particlesEnabled=!this.particlesEnabled,l["Enable Particles"].value=this.particlesEnabled}getFrameRateInfo(){const t=window.screen?.refreshRate||window.screen?.mozRefreshRate||window.screen?.webkitRefreshRate||"unknown";return{currentFps:this.currentFps,displayRefreshRate:t,pixelRatio:window.devicePixelRatio,isHighRefreshRate:t>=120||this.currentFps>=100,deltaTimeCap:"30fps minimum"}}formatNumber(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}formatTimeDetailed(t){const e=Math.floor(t/31557600),a=Math.floor(t%(365.25*24*60*60)/(30.44*24*60*60)),i=Math.floor(t%(30.44*24*60*60)/(1440*60)),s=Math.floor(t%(1440*60)/3600),r=Math.floor(t%3600/60),n=Math.floor(t%60),o=[];let h="seconds";switch(e>=1?h="years":a>=1?h="months":i>=1?h="days":s>=1?h="hours":r>=1&&(h="minutes"),h){case"years":o.push(`${e}y`,`${a.toString().padStart(2,"0")}mo`,`${i.toString().padStart(2,"0")}d`,`${s.toString().padStart(2,"0")}h`,`${r.toString().padStart(2,"0")}m`,`${n.toString().padStart(2,"0")}s`);break;case"months":o.push(`${a.toString().padStart(2,"0")}mo`,`${i.toString().padStart(2,"0")}d`,`${s.toString().padStart(2,"0")}h`,`${r.toString().padStart(2,"0")}m`,`${n.toString().padStart(2,"0")}s`);break;case"days":o.push(`${i.toString().padStart(2,"0")}d`,`${s.toString().padStart(2,"0")}h`,`${r.toString().padStart(2,"0")}m`,`${n.toString().padStart(2,"0")}s`);break;case"hours":o.push(`${s.toString().padStart(2,"0")}h`,`${r.toString().padStart(2,"0")}m`,`${n.toString().padStart(2,"0")}s`);break;case"minutes":o.push(`${r.toString().padStart(2,"0")}m`,`${n.toString().padStart(2,"0")}s`);break;default:o.push(`${n.toString().padStart(2,"0")}s`);break}return o.join(" ")}}document.addEventListener("DOMContentLoaded",()=>{window.dataCalculator=new z,window.getFrameRateInfo=()=>window.dataCalculator?window.dataCalculator.getFrameRateInfo():{error:"DataCalculator not initialized"}});
